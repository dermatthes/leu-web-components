(()=>{var tt=Object.create;var W=Object.defineProperty;var Ee=Object.getOwnPropertyDescriptor;var nt=Object.getOwnPropertyNames,we=Object.getOwnPropertySymbols,it=Object.getPrototypeOf,Ae=Object.prototype.hasOwnProperty,at=Object.prototype.propertyIsEnumerable;var ge=(t,n,i)=>n in t?W(t,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[n]=i,D=(t,n)=>{for(var i in n||={})Ae.call(n,i)&&ge(t,i,n[i]);if(we)for(var i of we(n))at.call(n,i)&&ge(t,i,n[i]);return t};var m=(t,n)=>()=>(n||t((n={exports:{}}).exports,n),n.exports);var lt=(t,n,i,a)=>{if(n&&typeof n=="object"||typeof n=="function")for(let o of nt(n))!Ae.call(t,o)&&o!==i&&W(t,o,{get:()=>n[o],enumerable:!(a=Ee(n,o))||a.enumerable});return t};var g=(t,n,i)=>(i=t!=null?tt(it(t)):{},lt(n||!t||!t.__esModule?W(i,"default",{value:t,enumerable:!0}):i,t));var H=(t,n,i,a)=>{for(var o=a>1?void 0:a?Ee(n,i):n,l=t.length-1,u;l>=0;l--)(u=t[l])&&(o=(a?u(n,i,o):u(o))||o);return a&&o&&W(n,i,o),o};var Me=(t,n,i)=>{if(!n.has(t))throw TypeError("Cannot "+i)};var p=(t,n,i)=>(Me(t,n,"read from private field"),i?i.call(t):n.get(t)),x=(t,n,i)=>{if(n.has(t))throw TypeError("Cannot add the same private member more than once");n instanceof WeakSet?n.add(t):n.set(t,i)},y=(t,n,i,a)=>(Me(t,n,"write to private field"),a?a.call(t,i):n.set(t,i),i);var v=(t,n,i)=>new Promise((a,o)=>{var l=_=>{try{c(i.next(_))}catch(f){o(f)}},u=_=>{try{c(i.throw(_))}catch(f){o(f)}},c=_=>_.done?a(_.value):Promise.resolve(_.value).then(l,u);c((i=i.apply(t,n)).next())});var Te=m(q=>{"use strict";var rt=q&&q.__awaiter||function(t,n,i,a){function o(l){return l instanceof i?l:new i(function(u){u(l)})}return new(i||(i=Promise))(function(l,u){function c(s){try{f(a.next(s))}catch(d){u(d)}}function _(s){try{f(a.throw(s))}catch(d){u(d)}}function f(s){s.done?l(s.value):o(s.value).then(c,_)}f((a=a.apply(t,n||[])).next())})};Object.defineProperty(q,"__esModule",{value:!0});q.ka_sleep=void 0;function ot(t){return rt(this,void 0,void 0,function*(){return new Promise(n=>{window.setTimeout(()=>n(),t)})})}q.ka_sleep=ot});var Ce=m(Y=>{"use strict";Object.defineProperty(Y,"__esModule",{value:!0});Y.ka_create_element=void 0;function st(t,n=null,i=null,a=null){let o=document.createElement(t);n===null&&(n={});for(let l in n)o.setAttribute(l,n[l]);if(Array.isArray(i))for(let l of i)o.appendChild(l);return a!==null&&a.appendChild(o),o}Y.ka_create_element=st});var $e=m(S=>{"use strict";var ut=S&&S.__awaiter||function(t,n,i,a){function o(l){return l instanceof i?l:new i(function(u){u(l)})}return new(i||(i=Promise))(function(l,u){function c(s){try{f(a.next(s))}catch(d){u(d)}}function _(s){try{f(a.throw(s))}catch(d){u(d)}}function f(s){s.done?l(s.value):o(s.value).then(c,_)}f((a=a.apply(t,n||[])).next())})};Object.defineProperty(S,"__esModule",{value:!0});S.ka_dom_ready=void 0;function ft(){return ut(this,void 0,void 0,function*(){return new Promise(t=>{if(document.readyState==="complete"||document.readyState==="interactive")return t("loaded");document.addEventListener("DOMContentLoaded",()=>t("DOMContentLoaded"))})})}S.ka_dom_ready=ft});var Le=m(U=>{"use strict";Object.defineProperty(U,"__esModule",{value:!0});U.customElement=void 0;function dt(t){return function(n){return console.debug("registering custom element",n,t),customElements.define(t,n),n}}U.customElement=dt});var ue=m((exports,module)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.ka_eval=void 0;function ka_eval(stmt,__scope,e,__refs){stmt.endsWith(";")&&(stmt=stmt.slice(0,-1));let reserved=["var","null","let","const","function","class","in","of","for","true","false","await","$this"],r="var $this = e;";for(let t in __scope)if(reserved.indexOf(t)===-1){if(t.indexOf("-")!==-1)throw console.error(`Invalid scope key '${t}': Cannot contain - in scope:`,__scope),`eval() failed: Invalid scope key: '${t}': Cannot contain minus char '-'`;r+=`var ${t} = __scope['${t}'];`}typeof __scope.$scope>"u"&&(r+="var $scope = __scope;");try{return eval(r+"("+stmt+")")}catch(t){throw console.error("cannot eval() stmt: '"+stmt+"': "+t," on element ",e,t,"(context:",__scope,")"),"eval('"+stmt+"') failed: "+t}}exports.ka_eval=ka_eval});var fe=m(Z=>{"use strict";Object.defineProperty(Z,"__esModule",{value:!0});Z.ka_elwalk=void 0;function je(t,n,i=!1,a=!1){if(Array.isArray(t)&&(t.children=t),!(typeof t.children>"u")){if(a&&t instanceof HTMLElement&&n(t)===!1)return!1;for(let o of t.children)n(o)!==!1&&i&&typeof o.children<"u"&&je(o,n,i)}}Z.ka_elwalk=je});var xe=m(Q=>{"use strict";Object.defineProperty(Q,"__esModule",{value:!0});Q.ka_str_to_camel_case=void 0;function ct(t){return t.replace(/(?:^\w|[A-Z]|\b\w)/g,(n,i)=>i===0?n.toLowerCase():n.toUpperCase()).replace(/[^a-zA-Z0-9]+/g,"")}Q.ka_str_to_camel_case=ct});var He=m(V=>{"use strict";var _t=V&&V.__awaiter||function(t,n,i,a){function o(l){return l instanceof i?l:new i(function(u){u(l)})}return new(i||(i=Promise))(function(l,u){function c(s){try{f(a.next(s))}catch(d){u(d)}}function _(s){try{f(a.throw(s))}catch(d){u(d)}}function f(s){s.done?l(s.value):o(s.value).then(c,_)}f((a=a.apply(t,n||[])).next())})};Object.defineProperty(V,"__esModule",{value:!0});V.ka_apply=void 0;var T=ue(),G=xe();function Oe(t,n,i=!1){typeof t=="string"&&(t=KaToolsV1.querySelector(t));let a={textcontent:"textContent",htmlcontent:"innerHTML",innerhtml:"innerHTML"};for(let o of t.getAttributeNames()){if(!o.startsWith("ka."))continue;let l=t.getAttribute(o),u=o.split(".")[1],c=o.split(".")[2];typeof c>"u"&&(c=null);let _=function(s,d,h,C){typeof s._ka_on>"u"&&(s._ka_on={}),typeof s._ka_on[d]>"u"&&s.addEventListener(d,O=>s._ka_on[d](O)),s._ka_on[d]=O=>_t(this,void 0,void 0,function*(){return C.$event=O,typeof h=="function"?h(O,s,C):(0,T.ka_eval)(h,C,s)})};if(u==="on"){let s=Object.assign({$scope:n},n);if(c!==null)_(t,c,l,s);else{let d=KaToolsV1.eval(l,s,t);for(let h in d)_(t,h,d[h],s)}continue}let f=null;switch(typeof l<"u"&&typeof l!==null&&l!==""&&(f=(0,T.ka_eval)(l,n,t)),u){case"ref":typeof n.$ref>"u"&&(n.$ref={}),f!==null&&(n.$ref[f]=t),n.$ref.$last=t;break;case"classlist":if(c!==null){f===!0?t.classList.add(c):t.classList.remove(c);break}for(let d in f)f[d]===!0?t.classList.add(d):t.classList.remove(d);break;case"style":if(c!==null){let d=f;typeof d=="number"&&["left","top","height","width","bottom","right","line-height","font-size"].indexOf(c)!==-1&&(d=d+"px"),t.style[(0,G.ka_str_to_camel_case)(c)]=d;break}for(let d in f){let h=f[d];typeof h=="number"&&["left","top","height","width","bottom","right","line-height","font-size"].indexOf(d)!==-1&&(h=h+"px"),t.style[(0,G.ka_str_to_camel_case)(d)]=h}break;case"bindarray":if(c==="default")continue;if(typeof f>"u"&&t.hasAttribute("ka.bind.default")&&(n=Object.assign({$scope:n},n),n=Object.assign(Object.assign({$scope:n},n),{__curVal:(0,T.ka_eval)(t.getAttribute("ka.bind.default"),n,t)}),(0,T.ka_eval)(`${l} = __curVal`,n,t),f=n.__curVal),!Array.isArray(f)){console.error("kap:bindarr: Not an array!",f,t);return}f.indexOf(t.value)===-1?t.checked=!1:t.checked=!0,typeof t._kap_bind>"u"&&(t.addEventListener("change",d=>{let h=(0,T.ka_eval)(l,n,t);h.indexOf(t.value)===-1&&t.checked&&h.push(t.value),h.indexOf(t.value)!==-1&&!t.checked&&(h=h.filter(C=>C!==t.value)),n=Object.assign(Object.assign({$scope:n},n),{__curVal:h}),(0,T.ka_eval)(`${l} = __curVal`,n,t),n.$on&&n.$on.change&&n.$on.change(d)}),t._kap_bind=!0);break;case"bind":if(c==="default")continue;typeof f>"u"&&t.hasAttribute("ka.bind.default")&&(n=Object.assign({$scope:n},n),n=Object.assign(Object.assign({$scope:n},n),{__curVal:(0,T.ka_eval)(t.getAttribute("ka.bind.default"),n,t)}),(0,T.ka_eval)(`${l} = __curVal`,n,t),f=n.__curVal),t.type==="checkbox"||t.type==="radio"?t.hasAttribute("value")?f===t.getAttribute("value")?t.checked=!0:t.checked=!1:f===!0?t.checked=!0:t.checked=!1:t.value=typeof f<"u"?f:"",typeof t._kap_bind>"u"&&(t.addEventListener("change",d=>{let h=null;if(t.type==="checkbox"||t.type==="radio")if(t.hasAttribute("value")){if(t.checked===!1)return;h=t.getAttribute("value")}else h=t.checked;else h=t.value;n=Object.assign(Object.assign({$scope:n},n),{__curVal:h}),(0,T.ka_eval)(`${l} = __curVal`,n,t),n.$on&&n.$on.change&&n.$on.change(d)}),t.addEventListener("keyup",d=>{n=Object.assign(Object.assign({$scope:n},n),{__curVal:t.value}),(0,T.ka_eval)(`${l} = __curVal`,n,t),n.$on&&n.$on.change&&n.$on.change(d)}),t._kap_bind=!0);break;case"options":let s=t.value;t.innerHTML="";for(let d in f)isNaN(d)?t.appendChild(new Option(f[d],d)):typeof f[d].text<"u"?t.appendChild(new Option(f[d].text,f[d].value)):t.appendChild(new Option(f[d],f[d]));s!==null&&(t.value=s);break;case"attr":if(c!==null){f===null||f===!1?t.removeAttribute(c):t.setAttribute(c,f);break}for(let d in f)f[d]===null||f[d]===!1?t.removeAttribute(d):t.setAttribute(d,f[d]);break;case"prop":if(c!==null){t[(0,G.ka_str_to_camel_case)(c)]=f;break}for(let d in f)t[(0,G.ka_str_to_camel_case)(d)]=f[d];break;default:typeof a[u]<"u"&&(u=a[u]),typeof t[u]>"u"&&console.warn("apply(): trying to set undefined property ",u,"on element",t),t[u]=f;break}}if(i)for(let o of t.children)Oe(o,n,i)}V.ka_apply=Oe});var de=m(J=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0});J.ka_query_selector=void 0;function ht(t,n,i){typeof i>"u"&&(i=`querySelector '${t}' not found`),(typeof n>"u"||n===null)&&(n=document);let a=n.querySelectorAll(t);if(a.length===0)throw console.warn(i,"on parent: ",n),i;return a[0]}J.ka_query_selector=ht});var ce=m(ee=>{"use strict";Object.defineProperty(ee,"__esModule",{value:!0});ee.ka_templatify=void 0;var pt=de(),mt=fe();window._ka_el_idx=0;function X(t,n=!0){if(typeof t=="string"&&(t=(0,pt.ka_query_selector)(t)),!(t instanceof Node))throw console.error("[ka-templatify] Parameter 1 is not a html element: ",t),`[ka-templify] Parameter 1 is not a html element: ${t}`;if(n){let a=document.createElement("template");return a.setAttribute("_kaidx",(window._ka_el_idx++).toString()),a.innerHTML=t.innerHTML.replace(/\[\[(.*?)\]\]/g,(o,l)=>`<span ka.textContent="${l}"></span>`),X(a.content,!1),a}t instanceof HTMLTemplateElement&&(t=t.content);let i=(a,o,l)=>{let u=document.createElement("template");u.setAttribute("_kaidx",(window._ka_el_idx++).toString());let c=a.cloneNode(!0);return c.removeAttribute(o),u.content.append(c),u.setAttribute(o,l),a.replaceWith(u),u};(0,mt.ka_elwalk)(t,a=>{if(!a instanceof HTMLElement)return;let o=null;for(let l of a.getAttributeNames()){if(l==="ka.for"){o=i(a,"ka.for",a.getAttribute("ka.for")),X(o,!1);break}if(l==="ka.if"){o=i(a,"ka.if",a.getAttribute("ka.if")),X(o,!1);break}}},!0,!1)}ee.ka_templatify=X});var qe=m(N=>{"use strict";var yt=N&&N.__awaiter||function(t,n,i,a){function o(l){return l instanceof i?l:new i(function(u){u(l)})}return new(i||(i=Promise))(function(l,u){function c(s){try{f(a.next(s))}catch(d){u(d)}}function _(s){try{f(a.throw(s))}catch(d){u(d)}}function f(s){s.done?l(s.value):o(s.value).then(c,_)}f((a=a.apply(t,n||[])).next())})};Object.defineProperty(N,"__esModule",{value:!0});N.ka_load_html=void 0;function kt(t){return yt(this,void 0,void 0,function*(){let n=document.createElement("template"),i=yield fetch(t);if(!i.ok)throw console.error(`[loadHtml] failed to load '${t}'`),`[loadHtml] failed to load '${t}'`;let a=yield i.text();return n.innerHTML=a,n})}N.ka_load_html=kt});var Se=m(P=>{"use strict";var vt=P&&P.__awaiter||function(t,n,i,a){function o(l){return l instanceof i?l:new i(function(u){u(l)})}return new(i||(i=Promise))(function(l,u){function c(s){try{f(a.next(s))}catch(d){u(d)}}function _(s){try{f(a.throw(s))}catch(d){u(d)}}function f(s){s.done?l(s.value):o(s.value).then(c,_)}f((a=a.apply(t,n||[])).next())})};Object.defineProperty(P,"__esModule",{value:!0});P.RemoteTemplate=void 0;var bt=qe(),_e=class{constructor(n){this.url=n,this.tpl=null}load(){return vt(this,void 0,void 0,function*(){return this.tpl===null&&(this.tpl=yield(0,bt.ka_load_html)(this.url)),this.tpl})}};P.RemoteTemplate=_e});var Ve=m(R=>{"use strict";var he=R&&R.__awaiter||function(t,n,i,a){function o(l){return l instanceof i?l:new i(function(u){u(l)})}return new(i||(i=Promise))(function(l,u){function c(s){try{f(a.next(s))}catch(d){u(d)}}function _(s){try{f(a.throw(s))}catch(d){u(d)}}function f(s){s.done?l(s.value):o(s.value).then(c,_)}f((a=a.apply(t,n||[])).next())})};Object.defineProperty(R,"__esModule",{value:!0});R.KaCustomElement=void 0;var wt=ce(),gt=me(),Et=de(),At=Se(),pe=class extends HTMLElement{constructor(n){super(n),this.__tpl=null,this.__isConnected=!1}get $tpl(){return this.__tpl}isConnected(){return this.isConnected}connected(n,i){return he(this,void 0,void 0,function*(){console.warn("connected() method not overridden in",this)})}connectedCallback(){return he(this,void 0,void 0,function*(){let n=this.constructor.__callback;if(n===null||n.bind(this),this.constructor.__tpl!==null){let i=this.constructor.__tpl;i instanceof At.RemoteTemplate&&(i=yield i.load());let a=(0,wt.ka_templatify)(i);this.constructor.__options.shadowDom===!0?this.attachShadow(this.constructor.__options.shadowDomOptions).appendChild(a):this.appendChild(a),this.__tpl=new gt.KaTemplate(a)}if(this.constructor.__options.waitEvent!==null){let i=this.constructor.__options.waitEvent.split("@"),a=i[0],o=document;i.length===2&&(o=(0,Et.ka_query_selector)(i[1])),o.addEventListener(a,l=>he(this,void 0,void 0,function*(){n(this.$tpl,this),this.__isConnected=!0}));return}if(n===null){yield this.connected(this.$tpl,this),this.__isConnected=!0;return}n(this.$tpl,this),this.__isConnected=!0})}};R.KaCustomElement=pe});var me=m(te=>{"use strict";Object.defineProperty(te,"__esModule",{value:!0});te.KaTemplate=void 0;var Ne=ue(),Mt=fe(),Tt=He(),Ct=Ve(),ye=class{constructor(n){this.template=n,typeof this.template.__kachilds>"u"&&(this.template.__kachilds=[]),typeof this.template.__kasibling>"u"&&(this.template.__kasibling=this.template.nextElementSibling),this.__renderCount=0,this.$scope={}}_error(n){throw console.error(`[ka-template] ${n} on element`,this.template),`[ka-template] ${n} on element`+this.template}_appendTemplate(){let n=this.template.content,i=[];for(let a of n.children)a=a.cloneNode(!0),a._ka_maintained_by=this.template.getAttribute("_kaidx"),i.push(a),this.template.parentNode.insertBefore(a,this.template.__kasibling);this.template.__kachilds.push(i)}_removeLastChild(){if(this.template.__kachilds.length===0)return;let n=this.template.__kachilds[this.template.__kachilds.length-1];for(let i of n)this.template.parentElement.removeChild(i);this.template.__kachilds.length=this.template.__kachilds.length-1}_renderFor(n,i){let a=i.match(/^(let)?\s*(?<target>.+)\s+(?<type>of|in|repeat)\s+(?<select>.+)$/);a===null&&this._error(`Can't parse ka.for='${i}'`);let o=(0,Ne.ka_eval)(a.groups.select,n,this.template);a.groups.type==="repeat"&&(typeof o!="number"&&this._error(`Error ka.for='${i}': Selected val must be number in repeat loop`),o=new Array(o).fill(null));let l=0;for(let u in o){let c=Object.assign({$scope:n},n);c[a.groups.target]=u,a.groups.type==="of"&&(c[a.groups.target]=o[u]),this.template.__kachilds.length<l+1&&this._appendTemplate(),this._maintain(c,this.template.__kachilds[l],l),l++}for(let u=l;u<this.template.__kachilds.length;)this._removeLastChild()}_maintain(n,i,a=0){for(let o of i)o._ka_for_index=a,(0,Mt.ka_elwalk)(o,l=>{if(l instanceof HTMLTemplateElement)return new this.constructor(l).render(n),!1;if(typeof l._ka_maintained_by<"u"&&l._ka_maintained_by!==this.template.getAttribute("_kaidx")||((0,Tt.ka_apply)(l,n),l instanceof HTMLElement&&(l.hasAttribute("ka.stop")||l instanceof Ct.KaCustomElement)))return!1},!0,!0)}_renderIf(n,i){(0,Ne.ka_eval)(i,n,this.template)===!0?(this.template.__kachilds.length===0&&this._appendTemplate(),this._maintain(n,this.template.__kachilds[0])):this._removeLastChild()}dispose(){for(;this.template.__kachilds.length>0;)this._removeLastChild()}render(n=null){n===null&&(n=this.$scope),this.$scope=n,this.__renderCount++,this.template.hasAttribute("ka.for")?this._renderFor(n,this.template.getAttribute("ka.for")):this.template.hasAttribute("ka.if")?this._renderIf(n,this.template.getAttribute("ka.if")):(typeof this.template._ka_active>"u"&&(this._appendTemplate(),this.template._ka_active=!0),this._maintain(n,this.template.__kachilds))}isFirstRender(){return this.__renderCount===1}};te.KaTemplate=ye});var Pe=m(ne=>{"use strict";Object.defineProperty(ne,"__esModule",{value:!0});ne.ka_html=void 0;function $t(t){let n=document.createElement("template");return n.innerHTML=t,n}ne.ka_html=$t});var Ke=m(K=>{"use strict";var Re=K&&K.__awaiter||function(t,n,i,a){function o(l){return l instanceof i?l:new i(function(u){u(l)})}return new(i||(i=Promise))(function(l,u){function c(s){try{f(a.next(s))}catch(d){u(d)}}function _(s){try{f(a.throw(s))}catch(d){u(d)}}function f(s){s.done?l(s.value):o(s.value).then(c,_)}f((a=a.apply(t,n||[])).next())})};Object.defineProperty(K,"__esModule",{value:!0});K.KaHtmlElement=void 0;var Lt=me(),jt=ce(),xt=Pe(),ke=class extends HTMLElement{constructor(n=null){super(),this.shadowRootInit=n,this.addEventListener("load",i=>console.log(i))}connectedCallback(){return Re(this,void 0,void 0,function*(){let n;if(typeof this.html=="function"){let a=this.html;n=yield a(this)}typeof n=="string"&&(n=(0,xt.ka_html)(n));let i=this;if(this.shadowRootInit!==null&&(i=this.attachShadow(this.shadowRootInit)),this.html!==null){let a=(0,jt.ka_templatify)(n);this.$tpl=new Lt.KaTemplate(a),i.appendChild(a)}this.connected()})}disconnectedCallback(){return Re(this,void 0,void 0,function*(){this.disconnected()})}};K.KaHtmlElement=ke});var w=m(b=>{"use strict";var Ot=b&&b.__createBinding||(Object.create?function(t,n,i,a){a===void 0&&(a=i);var o=Object.getOwnPropertyDescriptor(n,i);(!o||("get"in o?!n.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,a,o)}:function(t,n,i,a){a===void 0&&(a=i),t[a]=n[i]}),ie=b&&b.__exportStar||function(t,n){for(var i in t)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&Ot(n,t,i)};Object.defineProperty(b,"__esModule",{value:!0});b.ka_dom_ready=void 0;ie(Te(),b);ie(Ce(),b);var Ht=$e();Object.defineProperty(b,"ka_dom_ready",{enumerable:!0,get:function(){return Ht.ka_dom_ready}});ie(Le(),b);ie(Ke(),b)});var Ie=g(w(),1);var ae=class{constructor(n=86){window.addEventListener("hashchange",i=>v(this,null,function*(){console.log(i),i.preventDefault(),yield(0,Ie.ka_sleep)(1);let a=document.getElementById(window.location.hash.slice(1));if(a===null)return;let o=a.getBoundingClientRect().top+window.scrollY-n;console.log("scrollto",a,window.location.hash,a.getBoundingClientRect().top,o),window.scrollTo({top:o,behavior:"smooth"})}))}};var Be=g(w(),1),ze=g(w(),1),Fe=g(w(),1),We=g(w(),1);var le=class extends Be.KaHtmlElement{constructor(){super(...arguments);this.html=()=>v(this,null,function*(){let i=this.innerHTML;return this.innerHTML="",i})}connected(){return v(this,null,function*(){yield(0,Fe.ka_dom_ready)(),this.style.display="contents";let i={elements:[]};document.querySelectorAll("[data-leu-nav]").forEach(a=>{i.elements.push({el:a,title:a.getAttribute("data-leu-nav"),id:a.id,active:!1})}),window.addEventListener("scroll",()=>v(this,null,function*(){yield(0,We.ka_sleep)(100);let a=!1;for(let o of i.elements)o.active=!1,o.el.getBoundingClientRect().top+window.scrollY+10>window.scrollY&&!a&&(a=!0,o.active=!0);this.$tpl.render()}),{passive:!0}),this.removeAttribute("hidden"),this.$tpl.render(i)})}disconnected(){return v(this,null,function*(){})}};le=H([(0,ze.customElement)("leu-data-nav")],le);var De=g(w(),1),Ye=g(w(),1),Ue=g(w(),1),Ze=g(w(),1);typeof window.LeuFormatConfig=="undefined"&&(window.LeuFormatConfig={h1:["fs-2","text-center","content-space-2"],h2:["fs-3","mt-5"],hr:["clearboth"],img:["float-start","w-lg-50","w-100","pt-2","pb-2","pe-4"]});var re=class extends De.KaHtmlElement{constructor(){super(...arguments);this.html=null}connected(){return v(this,null,function*(){yield(0,Ue.ka_dom_ready)(),yield(0,Ze.ka_sleep)(1);let i=LeuFormatConfig;for(let l of this.getAttributeNames())i[l]=this.getAttribute(l).split(" ");for(let l in i)for(let u of Array.from(this.querySelectorAll(l))){let c=i[l];for(let _ of c)u.classList.add(_)}let a=null,o=0;e:do{if(this.children.length<o+1)break;let l=this.children[o],u=l.querySelector("[container]");if(u!==null){a=u,o++;continue}if(a===null){o++;continue}a.append(l)}while(!0)})}disconnected(){return v(this,null,function*(){})}};re=H([(0,Ye.customElement)("leu-format")],re);var M=g(w(),1);var Qe=g(w(),1);function ve(t,n="@"){let i={},a=new RegExp(`\\${n}[^${n}]+`,"gi");return t.replace(a,o=>{if(o=o.substring(1),o.indexOf("=")===-1)typeof i.class=="undefined"&&(i.class=""),i.class+=" "+o,i.class=i.class.trim();else{let l=o.split("=",2);i[l[0]]=l[1]}return""}),i}function be(t){return ve(t,"@")}function Ge(t){let n=t.trim(),i="div";n=n.replace(/^[a-z0-9_\:\-]+/ig,l=>(i=l,""));let a=be(n);return(0,Qe.ka_create_element)(i,a)}var F={},$,E,I,L,B,A,oe=class extends HTMLElement{constructor(){super(...arguments);x(this,$,null);x(this,E,null);x(this,I,null);x(this,L,null);x(this,B,new Map);x(this,A,D({},F))}createElementTree(i){let a=null,o=null;for(let l of i.split(">")){let u=null;l=l.replace(/§([a-z0-9_\-]+)/,(_,f)=>(u=f,""));let c=Ge(l);u!==null&&(p(this,B)[u]=c),a===null?a=o=c:(o.appendChild(c),o=c)}return{start:a,leaf:o}}parseComment(i){p(this,E).append(i.cloneNode(!0));let a=i.textContent.split(`
`);for(let o of a){if(o=o.trim(),o==="")continue;let l=o.substring(1).trim();switch(o.substring(0,1)){case"/":let u=this.createElementTree(l);p(this,L).appendChild(u.start),y(this,I,u.start),y(this,$,y(this,E,u.leaf)),y(this,A,D({},F));break;case"!":let c=l.trim().split(" ",1).join(),_=ve(l,"$"),f=document.querySelector(`template[id='${c}']`);if(f===null){console.error("<template id='",c,"'> not found. Selected in ",i);break}let s=document.createElement("div"),d=f.content.firstElementChild.outerHTML.replace(/\$\{(.*?)(\?(.*?))?\}/gi,(k,j,se,et)=>typeof _[j]!="undefined"?_[j]:et);d=d.replace(/--([a-z\-]+)=/ig,(k,j)=>j+"="),s.innerHTML=d,p(this,E).append(s);for(let k of s.querySelectorAll("script")){let j={};k.hasAttribute("src")&&(j={src:k.getAttribute("src")});let se=(0,M.ka_create_element)("script",j);se.append(document.createTextNode(k.textContent)),k.parentElement.replaceChild(se,k)}let h=s.querySelectorAll("[attach]");for(let k of h)k.getAttribute("attach")===""?(y(this,E,k),y(this,$,k)):p(this,B)[k.getAttribute("attach")]=k;h.length===0&&console.warn("Template has no attach point",f,s);break;case">":let C=this.createElementTree(l);p(this,$).appendChild(C.start),y(this,E,C.leaf);break;case"~":let[O,...Je]=l.split("=>"),Xe=be(Je.join(":"));p(this,A)[O]={attrs:Xe,line:o};break;case"?":let z=null;if(l.startsWith("\xA7")){if(z=p(this,B)[l.substring(1)],z===null){console.error("Cannot select reference: '"+o+"': Not found");break}}else if(z=p(this,I).querySelector(l),z===null){console.error(`Query Element '${l}': not found in `,i,"in",p(this,L));break}y(this,$,y(this,E,z));break;case"#":case"*":break;default:throw console.error("Cannot parse sequence: "+o+" of block",i),"Cannot parse sequence: "+o}}}applyAttMap(i){let a=document.createElement("div");a.append(i);for(let o in p(this,A))try{let l=a.querySelectorAll(o);for(let u of Array.from(l))for(let c in p(this,A)[o].attrs)u.setAttribute(c,p(this,A)[o].attrs[c])}catch(l){console.error("Cannot evaluate: '"+p(this,A)[o].line+"' - ",l);continue}}connectedCallback(){return v(this,null,function*(){yield(0,M.ka_dom_ready)(),yield(0,M.ka_sleep)(1),this.hasAttribute("default")||(yield(0,M.ka_sleep)(1)),y(this,A,D({},F)),y(this,L,y(this,I,y(this,E,y(this,$,(0,M.ka_create_element)("div",{class:this.getAttribute("class")+" loading"},[]))))),this.parentElement.insertBefore(p(this,L),this.nextElementSibling);for(let i of Array.from(this.childNodes)){if(i instanceof Comment){this.parseComment(i);continue}let a=i.cloneNode(!0);this.applyAttMap(a),p(this,E).append(a)}this.hasAttribute("default")&&(F=p(this,A),console.debug("Register default attribute map: ",F,"from",this)),yield(0,M.ka_sleep)(10),p(this,L).classList.remove("loading"),this.classList.remove("loading"),this.style.display="none"})}disconnectedCallback(){return v(this,null,function*(){})}};$=new WeakMap,E=new WeakMap,I=new WeakMap,L=new WeakMap,B=new WeakMap,A=new WeakMap,oe=H([(0,M.customElement)("leu-content")],oe);var _n={SmoothScroll:ae};})();
