(()=>{var yt=Object.create;var te=Object.defineProperty;var Be=Object.getOwnPropertyDescriptor;var kt=Object.getOwnPropertyNames,Se=Object.getOwnPropertySymbols,vt=Object.getPrototypeOf,Ie=Object.prototype.hasOwnProperty,bt=Object.prototype.propertyIsEnumerable;var Ve=(n,t,i)=>t in n?te(n,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[t]=i,O=(n,t)=>{for(var i in t||={})Ie.call(t,i)&&Ve(n,i,t[i]);if(Se)for(var i of Se(t))bt.call(t,i)&&Ve(n,i,t[i]);return n};var k=(n,t)=>()=>(t||n((t={exports:{}}).exports,t),t.exports);var wt=(n,t,i,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of kt(t))!Ie.call(n,s)&&s!==i&&te(n,s,{get:()=>t[s],enumerable:!(a=Be(t,s))||a.enumerable});return n};var y=(n,t,i)=>(i=n!=null?yt(vt(n)):{},wt(t||!n||!n.__esModule?te(i,"default",{value:n,enumerable:!0}):i,n));var w=(n,t,i,a)=>{for(var s=a>1?void 0:a?Be(t,i):t,l=n.length-1,u;l>=0;l--)(u=n[l])&&(s=(a?u(t,i,s):u(s))||s);return a&&s&&te(t,i,s),s};var Ne=(n,t,i)=>{if(!t.has(n))throw TypeError("Cannot "+i)};var p=(n,t,i)=>(Ne(n,t,"read from private field"),i?i.call(n):t.get(n)),x=(n,t,i)=>{if(t.has(n))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(n):t.set(n,i)},v=(n,t,i,a)=>(Ne(n,t,"write to private field"),a?a.call(n,i):t.set(n,i),i);var m=(n,t,i)=>new Promise((a,s)=>{var l=h=>{try{f(i.next(h))}catch(c){s(c)}},u=h=>{try{f(i.throw(h))}catch(c){s(c)}},f=h=>h.done?a(h.value):Promise.resolve(h.value).then(l,u);f((i=i.apply(n,t)).next())});var Pe=k(S=>{"use strict";var gt=S&&S.__awaiter||function(n,t,i,a){function s(l){return l instanceof i?l:new i(function(u){u(l)})}return new(i||(i=Promise))(function(l,u){function f(o){try{c(a.next(o))}catch(d){u(d)}}function h(o){try{c(a.throw(o))}catch(d){u(d)}}function c(o){o.done?l(o.value):s(o.value).then(f,h)}c((a=a.apply(n,t||[])).next())})};Object.defineProperty(S,"__esModule",{value:!0});S.ka_sleep=void 0;function Et(n){return gt(this,void 0,void 0,function*(){return new Promise(t=>{window.setTimeout(()=>t(),n)})})}S.ka_sleep=Et});var De=k(ne=>{"use strict";Object.defineProperty(ne,"__esModule",{value:!0});ne.ka_create_element=void 0;function Ct(n,t=null,i=null,a=null){let s=document.createElement(n);t===null&&(t={});for(let l in t)s.setAttribute(l,t[l]);if(Array.isArray(i))for(let l of i)s.appendChild(l);return a!==null&&a.appendChild(s),s}ne.ka_create_element=Ct});var Re=k(V=>{"use strict";var Tt=V&&V.__awaiter||function(n,t,i,a){function s(l){return l instanceof i?l:new i(function(u){u(l)})}return new(i||(i=Promise))(function(l,u){function f(o){try{c(a.next(o))}catch(d){u(d)}}function h(o){try{c(a.throw(o))}catch(d){u(d)}}function c(o){o.done?l(o.value):s(o.value).then(f,h)}c((a=a.apply(n,t||[])).next())})};Object.defineProperty(V,"__esModule",{value:!0});V.ka_dom_ready=void 0;function Mt(){return Tt(this,void 0,void 0,function*(){return new Promise(n=>{if(document.readyState==="complete"||document.readyState==="interactive")return n("loaded");document.addEventListener("DOMContentLoaded",()=>n("DOMContentLoaded"))})})}V.ka_dom_ready=Mt});var Ke=k(ie=>{"use strict";Object.defineProperty(ie,"__esModule",{value:!0});ie.customElement=void 0;function Lt(n){return function(t){return console.debug("registering custom element",t,n),customElements.define(n,t),t}}ie.customElement=Lt});var ae=k((exports,module)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.ka_eval=void 0;function ka_eval(stmt,__scope,e,__refs){stmt.endsWith(";")&&(stmt=stmt.slice(0,-1));let reserved=["var","null","let","const","function","class","in","of","for","true","false","await","$this"],r="var $this = e;";for(let n in __scope)if(reserved.indexOf(n)===-1){if(n.indexOf("-")!==-1)throw console.error(`Invalid scope key '${n}': Cannot contain - in scope:`,__scope),`eval() failed: Invalid scope key: '${n}': Cannot contain minus char '-'`;r+=`var ${n} = __scope['${n}'];`}typeof __scope.$scope>"u"&&(r+="var $scope = __scope;");try{return eval(r+"("+stmt+")")}catch(n){throw console.error("cannot eval() stmt: '"+stmt+"': "+n," on element ",e,n,"(context:",__scope,")"),"eval('"+stmt+"') failed: "+n}}exports.ka_eval=ka_eval});var Ee=k(le=>{"use strict";Object.defineProperty(le,"__esModule",{value:!0});le.ka_elwalk=void 0;function ze(n,t,i=!1,a=!1){if(Array.isArray(n)&&(n.children=n),!(typeof n.children>"u")){if(a&&n instanceof HTMLElement&&t(n)===!1)return!1;for(let s of n.children)t(s)!==!1&&i&&typeof s.children<"u"&&ze(s,t,i)}}le.ka_elwalk=ze});var We=k(re=>{"use strict";Object.defineProperty(re,"__esModule",{value:!0});re.ka_str_to_camel_case=void 0;function xt(n){return n.replace(/(?:^\w|[A-Z]|\b\w)/g,(t,i)=>i===0?t.toLowerCase():t.toUpperCase()).replace(/[^a-zA-Z0-9]+/g,"")}re.ka_str_to_camel_case=xt});var Ye=k(B=>{"use strict";var At=B&&B.__awaiter||function(n,t,i,a){function s(l){return l instanceof i?l:new i(function(u){u(l)})}return new(i||(i=Promise))(function(l,u){function f(o){try{c(a.next(o))}catch(d){u(d)}}function h(o){try{c(a.throw(o))}catch(d){u(d)}}function c(o){o.done?l(o.value):s(o.value).then(f,h)}c((a=a.apply(n,t||[])).next())})};Object.defineProperty(B,"__esModule",{value:!0});B.ka_apply=void 0;var L=ae(),se=We();function Fe(n,t,i=!1){typeof n=="string"&&(n=KaToolsV1.querySelector(n));let a={textcontent:"textContent",htmlcontent:"innerHTML",innerhtml:"innerHTML"};for(let s of n.getAttributeNames()){if(!s.startsWith("ka."))continue;let l=n.getAttribute(s),u=s.split(".")[1],f=s.split(".")[2];typeof f>"u"&&(f=null);let h=function(o,d,_,A){typeof o._ka_on>"u"&&(o._ka_on={}),typeof o._ka_on[d]>"u"&&o.addEventListener(d,q=>o._ka_on[d](q)),o._ka_on[d]=q=>At(this,void 0,void 0,function*(){return A.$event=q,typeof _=="function"?_(q,o,A):(0,L.ka_eval)(_,A,o)})};if(u==="on"){let o=Object.assign({$scope:t},t);if(f!==null)h(n,f,l,o);else{let d=KaToolsV1.eval(l,o,n);for(let _ in d)h(n,_,d[_],o)}continue}let c=null;switch(typeof l<"u"&&typeof l!==null&&l!==""&&(c=(0,L.ka_eval)(l,t,n)),u){case"ref":typeof t.$ref>"u"&&(t.$ref={}),c!==null&&(t.$ref[c]=n),t.$ref.$last=n;break;case"classlist":if(f!==null){c===!0?n.classList.add(f):n.classList.remove(f);break}for(let d in c)c[d]===!0?n.classList.add(d):n.classList.remove(d);break;case"style":if(f!==null){let d=c;typeof d=="number"&&["left","top","height","width","bottom","right","line-height","font-size"].indexOf(f)!==-1&&(d=d+"px"),n.style[(0,se.ka_str_to_camel_case)(f)]=d;break}for(let d in c){let _=c[d];typeof _=="number"&&["left","top","height","width","bottom","right","line-height","font-size"].indexOf(d)!==-1&&(_=_+"px"),n.style[(0,se.ka_str_to_camel_case)(d)]=_}break;case"bindarray":if(f==="default")continue;if(typeof c>"u"&&n.hasAttribute("ka.bind.default")&&(t=Object.assign({$scope:t},t),t=Object.assign(Object.assign({$scope:t},t),{__curVal:(0,L.ka_eval)(n.getAttribute("ka.bind.default"),t,n)}),(0,L.ka_eval)(`${l} = __curVal`,t,n),c=t.__curVal),!Array.isArray(c)){console.error("kap:bindarr: Not an array!",c,n);return}c.indexOf(n.value)===-1?n.checked=!1:n.checked=!0,typeof n._kap_bind>"u"&&(n.addEventListener("change",d=>{let _=(0,L.ka_eval)(l,t,n);_.indexOf(n.value)===-1&&n.checked&&_.push(n.value),_.indexOf(n.value)!==-1&&!n.checked&&(_=_.filter(A=>A!==n.value)),t=Object.assign(Object.assign({$scope:t},t),{__curVal:_}),(0,L.ka_eval)(`${l} = __curVal`,t,n),t.$on&&t.$on.change&&t.$on.change(d)}),n._kap_bind=!0);break;case"bind":if(f==="default")continue;typeof c>"u"&&n.hasAttribute("ka.bind.default")&&(t=Object.assign({$scope:t},t),t=Object.assign(Object.assign({$scope:t},t),{__curVal:(0,L.ka_eval)(n.getAttribute("ka.bind.default"),t,n)}),(0,L.ka_eval)(`${l} = __curVal`,t,n),c=t.__curVal),n.type==="checkbox"||n.type==="radio"?n.hasAttribute("value")?c===n.getAttribute("value")?n.checked=!0:n.checked=!1:c===!0?n.checked=!0:n.checked=!1:n.value=typeof c<"u"?c:"",typeof n._kap_bind>"u"&&(n.addEventListener("change",d=>{let _=null;if(n.type==="checkbox"||n.type==="radio")if(n.hasAttribute("value")){if(n.checked===!1)return;_=n.getAttribute("value")}else _=n.checked;else _=n.value;t=Object.assign(Object.assign({$scope:t},t),{__curVal:_}),(0,L.ka_eval)(`${l} = __curVal`,t,n),t.$on&&t.$on.change&&t.$on.change(d)}),n.addEventListener("keyup",d=>{t=Object.assign(Object.assign({$scope:t},t),{__curVal:n.value}),(0,L.ka_eval)(`${l} = __curVal`,t,n),t.$on&&t.$on.change&&t.$on.change(d)}),n._kap_bind=!0);break;case"options":let o=n.value;n.innerHTML="";for(let d in c)isNaN(d)?n.appendChild(new Option(c[d],d)):typeof c[d].text<"u"?n.appendChild(new Option(c[d].text,c[d].value)):n.appendChild(new Option(c[d],c[d]));o!==null&&(n.value=o);break;case"attr":if(f!==null){c===null||c===!1?n.removeAttribute(f):n.setAttribute(f,c);break}for(let d in c)c[d]===null||c[d]===!1?n.removeAttribute(d):n.setAttribute(d,c[d]);break;case"prop":if(f!==null){n[(0,se.ka_str_to_camel_case)(f)]=c;break}for(let d in c)n[(0,se.ka_str_to_camel_case)(d)]=c[d];break;default:typeof a[u]<"u"&&(u=a[u]),typeof n[u]>"u"&&console.warn("apply(): trying to set undefined property ",u,"on element",n),n[u]=c;break}}if(i)for(let s of n.children)Fe(s,t,i)}B.ka_apply=Fe});var X=k(oe=>{"use strict";Object.defineProperty(oe,"__esModule",{value:!0});oe.ka_query_selector=void 0;function Ht(n,t,i){typeof i>"u"&&(i=`querySelector '${n}' not found`),(typeof t>"u"||t===null)&&(t=document);let a=t.querySelectorAll(n);if(a.length===0)throw console.warn(i,"on parent: ",t),i;return a[0]}oe.ka_query_selector=Ht});var Ce=k(ce=>{"use strict";Object.defineProperty(ce,"__esModule",{value:!0});ce.ka_templatify=void 0;var $t=X(),jt=Ee();window._ka_el_idx=0;function ue(n,t=!0){if(typeof n=="string"&&(n=(0,$t.ka_query_selector)(n)),!(n instanceof Node))throw console.error("[ka-templatify] Parameter 1 is not a html element: ",n),`[ka-templify] Parameter 1 is not a html element: ${n}`;if(t){let a=document.createElement("template");return a.setAttribute("_kaidx",(window._ka_el_idx++).toString()),a.innerHTML=n.innerHTML.replace(/\[\[(.*?)\]\]/g,(s,l)=>`<span ka.textContent="${l}"></span>`),ue(a.content,!1),a}n instanceof HTMLTemplateElement&&(n=n.content);let i=(a,s,l)=>{let u=document.createElement("template");u.setAttribute("_kaidx",(window._ka_el_idx++).toString());let f=a.cloneNode(!0);return f.removeAttribute(s),u.content.append(f),u.setAttribute(s,l),a.replaceWith(u),u};(0,jt.ka_elwalk)(n,a=>{if(!(a instanceof HTMLElement))return;let s=null;for(let l of a.getAttributeNames()){if(l==="ka.for"){s=i(a,"ka.for",a.getAttribute("ka.for")),ue(s,!1);break}if(l==="ka.if"){s=i(a,"ka.if",a.getAttribute("ka.if")),ue(s,!1);break}}},!0,!1)}ce.ka_templatify=ue});var Ze=k(I=>{"use strict";var Ot=I&&I.__awaiter||function(n,t,i,a){function s(l){return l instanceof i?l:new i(function(u){u(l)})}return new(i||(i=Promise))(function(l,u){function f(o){try{c(a.next(o))}catch(d){u(d)}}function h(o){try{c(a.throw(o))}catch(d){u(d)}}function c(o){o.done?l(o.value):s(o.value).then(f,h)}c((a=a.apply(n,t||[])).next())})};Object.defineProperty(I,"__esModule",{value:!0});I.ka_load_html=void 0;function qt(n){return Ot(this,void 0,void 0,function*(){let t=document.createElement("template"),i=yield fetch(n);if(!i.ok)throw console.error(`[loadHtml] failed to load '${n}'`),`[loadHtml] failed to load '${n}'`;let a=yield i.text();return t.innerHTML=a,t})}I.ka_load_html=qt});var Qe=k(N=>{"use strict";var St=N&&N.__awaiter||function(n,t,i,a){function s(l){return l instanceof i?l:new i(function(u){u(l)})}return new(i||(i=Promise))(function(l,u){function f(o){try{c(a.next(o))}catch(d){u(d)}}function h(o){try{c(a.throw(o))}catch(d){u(d)}}function c(o){o.done?l(o.value):s(o.value).then(f,h)}c((a=a.apply(n,t||[])).next())})};Object.defineProperty(N,"__esModule",{value:!0});N.RemoteTemplate=void 0;var Vt=Ze(),Te=class{constructor(t){this.url=t,this.tpl=null}load(){return St(this,void 0,void 0,function*(){return this.tpl===null&&(this.tpl=yield(0,Vt.ka_load_html)(this.url)),this.tpl})}};N.RemoteTemplate=Te});var Ge=k(P=>{"use strict";var Me=P&&P.__awaiter||function(n,t,i,a){function s(l){return l instanceof i?l:new i(function(u){u(l)})}return new(i||(i=Promise))(function(l,u){function f(o){try{c(a.next(o))}catch(d){u(d)}}function h(o){try{c(a.throw(o))}catch(d){u(d)}}function c(o){o.done?l(o.value):s(o.value).then(f,h)}c((a=a.apply(n,t||[])).next())})};Object.defineProperty(P,"__esModule",{value:!0});P.KaCustomElement=void 0;var Bt=Ce(),It=xe(),Nt=X(),Pt=Qe(),Le=class extends HTMLElement{constructor(t){super(t),this.__tpl=null,this.__isConnected=!1}get $tpl(){return this.__tpl}isConnected(){return this.isConnected}connected(t,i){return Me(this,void 0,void 0,function*(){console.warn("connected() method not overridden in",this)})}connectedCallback(){return Me(this,void 0,void 0,function*(){let t=this.constructor.__callback;if(t===null||t.bind(this),this.constructor.__tpl!==null){let i=this.constructor.__tpl;i instanceof Pt.RemoteTemplate&&(i=yield i.load());let a=(0,Bt.ka_templatify)(i);this.constructor.__options.shadowDom===!0?this.attachShadow(this.constructor.__options.shadowDomOptions).appendChild(a):this.appendChild(a),this.__tpl=new It.KaTemplate(a)}if(this.constructor.__options.waitEvent!==null){let i=this.constructor.__options.waitEvent.split("@"),a=i[0],s=document;i.length===2&&(s=(0,Nt.ka_query_selector)(i[1])),s.addEventListener(a,l=>Me(this,void 0,void 0,function*(){t(this.$tpl,this),this.__isConnected=!0}));return}if(t===null){yield this.connected(this.$tpl,this),this.__isConnected=!0;return}t(this.$tpl,this),this.__isConnected=!0})}};P.KaCustomElement=Le});var xe=k(de=>{"use strict";Object.defineProperty(de,"__esModule",{value:!0});de.KaTemplate=void 0;var Je=ae(),Dt=Ee(),Rt=Ye(),Kt=Ge(),Ae=class{constructor(t){this.template=t,typeof this.template.__kachilds>"u"&&(this.template.__kachilds=[]),typeof this.template.__kasibling>"u"&&(this.template.__kasibling=this.template.nextElementSibling),this.__renderCount=0,this.$scope={}}_error(t){throw console.error(`[ka-template] ${t} on element`,this.template),`[ka-template] ${t} on element`+this.template}_appendTemplate(){let t=this.template.content,i=[];for(let a of t.children)a=a.cloneNode(!0),a._ka_maintained_by=this.template.getAttribute("_kaidx"),i.push(a),this.template.parentNode.insertBefore(a,this.template.__kasibling);this.template.__kachilds.push(i)}_removeLastChild(){if(this.template.__kachilds.length===0)return;let t=this.template.__kachilds[this.template.__kachilds.length-1];for(let i of t)this.template.parentElement.removeChild(i);this.template.__kachilds.length=this.template.__kachilds.length-1}_renderFor(t,i){let a=i.match(/^(let)?\s*(?<target>.+)\s+(?<type>of|in|repeat)\s+(?<select>.+)$/);a===null&&this._error(`Can't parse ka.for='${i}'`);let s=(0,Je.ka_eval)(a.groups.select,t,this.template);a.groups.type==="repeat"&&(typeof s!="number"&&this._error(`Error ka.for='${i}': Selected val must be number in repeat loop`),s=new Array(s).fill(null));let l=0;for(let u in s){let f=Object.assign({$scope:t},t);f[a.groups.target]=u,a.groups.type==="of"&&(f[a.groups.target]=s[u]),this.template.__kachilds.length<l+1&&this._appendTemplate(),this._maintain(f,this.template.__kachilds[l],l),l++}for(let u=l;u<this.template.__kachilds.length;)this._removeLastChild()}_maintain(t,i,a=0){for(let s of i)s._ka_for_index=a,(0,Dt.ka_elwalk)(s,l=>{if(l instanceof HTMLTemplateElement)return new this.constructor(l).render(t),!1;if(typeof l._ka_maintained_by<"u"&&l._ka_maintained_by!==this.template.getAttribute("_kaidx")||((0,Rt.ka_apply)(l,t),l instanceof HTMLElement&&(l.hasAttribute("ka.stop")||l instanceof Kt.KaCustomElement)))return!1},!0,!0)}_renderIf(t,i){(0,Je.ka_eval)(i,t,this.template)===!0?(this.template.__kachilds.length===0&&this._appendTemplate(),this._maintain(t,this.template.__kachilds[0])):this._removeLastChild()}dispose(){for(;this.template.__kachilds.length>0;)this._removeLastChild()}render(t=null){t===null&&(t=this.$scope),this.$scope=t,this.__renderCount++,this.template.hasAttribute("ka.for")?this._renderFor(t,this.template.getAttribute("ka.for")):this.template.hasAttribute("ka.if")?this._renderIf(t,this.template.getAttribute("ka.if")):(typeof this.template._ka_active>"u"&&(this._appendTemplate(),this.template._ka_active=!0),this._maintain(t,this.template.__kachilds))}isFirstRender(){return this.__renderCount===1}};de.KaTemplate=Ae});var He=k(fe=>{"use strict";Object.defineProperty(fe,"__esModule",{value:!0});fe.ka_html=void 0;function zt(n){let t=document.createElement("template");return t.innerHTML=n,t}fe.ka_html=zt});var Ue=k(D=>{"use strict";var Xe=D&&D.__awaiter||function(n,t,i,a){function s(l){return l instanceof i?l:new i(function(u){u(l)})}return new(i||(i=Promise))(function(l,u){function f(o){try{c(a.next(o))}catch(d){u(d)}}function h(o){try{c(a.throw(o))}catch(d){u(d)}}function c(o){o.done?l(o.value):s(o.value).then(f,h)}c((a=a.apply(n,t||[])).next())})};Object.defineProperty(D,"__esModule",{value:!0});D.KaHtmlElement=void 0;var Wt=xe(),Ft=Ce(),Yt=He(),$e=class extends HTMLElement{constructor(t=null){super(),this.shadowRootInit=t,this.addEventListener("load",i=>console.log(i))}connectedCallback(){return Xe(this,void 0,void 0,function*(){let t;if(typeof this.html=="function"){let a=this.html;t=yield a(this)}typeof t=="string"&&(t=(0,Yt.ka_html)(t));let i=this;if(this.shadowRootInit!==null&&(i=this.attachShadow(this.shadowRootInit)),this.html!==null){let a=(0,Ft.ka_templatify)(t);this.$tpl=new Wt.KaTemplate(a),i.appendChild(a)}this.connected()})}disconnectedCallback(){return Xe(this,void 0,void 0,function*(){this.disconnected()})}};D.KaHtmlElement=$e});var b=k(E=>{"use strict";var Zt=E&&E.__createBinding||(Object.create?function(n,t,i,a){a===void 0&&(a=i);var s=Object.getOwnPropertyDescriptor(t,i);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(n,a,s)}:function(n,t,i,a){a===void 0&&(a=i),n[a]=t[i]}),U=E&&E.__exportStar||function(n,t){for(var i in n)i!=="default"&&!Object.prototype.hasOwnProperty.call(t,i)&&Zt(t,n,i)};Object.defineProperty(E,"__esModule",{value:!0});E.ka_dom_ready=void 0;U(Pe(),E);U(De(),E);var Qt=Re();Object.defineProperty(E,"ka_dom_ready",{enumerable:!0,get:function(){return Qt.ka_dom_ready}});U(Ke(),E);U(Ue(),E);U(He(),E)});var et=y(b(),1);var he=class{constructor(t=86){window.addEventListener("hashchange",i=>m(this,null,function*(){console.log(i),i.preventDefault(),yield(0,et.ka_sleep)(1);let a=document.getElementById(window.location.hash.slice(1));if(a===null)return;let s=a.getBoundingClientRect().top+window.scrollY-t;console.log("scrollto",a,window.location.hash,a.getBoundingClientRect().top,s),window.scrollTo({top:s,behavior:"smooth"})}))}};var tt=y(b(),1),nt=y(b(),1),it=y(b(),1),at=y(b(),1);var _e=class extends tt.KaHtmlElement{constructor(){super(...arguments);this.html=()=>m(this,null,function*(){let i=this.innerHTML;return this.innerHTML="",i})}connected(){return m(this,null,function*(){yield(0,it.ka_dom_ready)(),this.style.display="contents";let i={elements:[]};document.querySelectorAll("[data-leu-nav]").forEach(a=>{i.elements.push({el:a,title:a.getAttribute("data-leu-nav"),id:a.id,active:!1})}),window.addEventListener("scroll",()=>m(this,null,function*(){yield(0,at.ka_sleep)(100);let a=!1;for(let s of i.elements)s.active=!1,s.el.getBoundingClientRect().top+window.scrollY+10>window.scrollY&&!a&&(a=!0,s.active=!0);this.$tpl.render()}),{passive:!0}),this.removeAttribute("hidden"),this.$tpl.render(i)})}disconnected(){return m(this,null,function*(){})}};_e=w([(0,nt.customElement)("leu-data-nav")],_e);var lt=y(b(),1),rt=y(b(),1),st=y(b(),1),ot=y(b(),1);typeof window.LeuFormatConfig=="undefined"&&(window.LeuFormatConfig={h1:["fs-2","text-center","content-space-2"],h2:["fs-3","mt-5"],hr:["clearboth"],img:["float-start","w-lg-50","w-100","pt-2","pb-2","pe-4"]});var pe=class extends lt.KaHtmlElement{constructor(){super(...arguments);this.html=null}connected(){return m(this,null,function*(){yield(0,st.ka_dom_ready)(),yield(0,ot.ka_sleep)(1);let i=LeuFormatConfig;for(let l of this.getAttributeNames())i[l]=this.getAttribute(l).split(" ");for(let l in i)for(let u of Array.from(this.querySelectorAll(l))){let f=i[l];for(let h of f)u.classList.add(h)}let a=null,s=0;e:do{if(this.children.length<s+1)break;let l=this.children[s],u=l.querySelector("[container]");if(u!==null){a=u,s++;continue}if(a===null){s++;continue}a.append(l)}while(!0)})}disconnected(){return m(this,null,function*(){})}};pe=w([(0,rt.customElement)("leu-format")],pe);var M=y(b(),1);var ut=y(b(),1);function je(n,t="@"){let i={},a=new RegExp(`\\${t}[^${t}]+`,"gi");return n.replace(a,s=>{if(s=s.substring(1),s.indexOf("=")===-1)typeof i.class=="undefined"&&(i.class=""),i.class+=" "+s,i.class=i.class.trim();else{let l=s.split("=",2);i[l[0]]=l[1]}return""}),i}function Oe(n){return je(n,"@")}function ct(n){let t=n.trim(),i="div";t=t.replace(/^[a-z0-9_\:\-]+/ig,l=>(i=l,""));let a=Oe(t);return(0,ut.ka_create_element)(i,a)}function qe(n,t){return t instanceof n?t:t.parentElement===null?null:qe(n,t.parentElement)}function R(n){return!(typeof n=="undefined"||n===null)}var ee={},H,C,K,$,z,T,me=class extends HTMLElement{constructor(){super(...arguments);x(this,H,null);x(this,C,null);x(this,K,null);x(this,$,null);x(this,z,new Map);x(this,T,O({},ee))}createElementTree(i){let a=null,s=null;for(let l of i.split(">")){let u=null;l=l.replace(/ยง([a-z0-9_\-]+)/,(h,c)=>(u=c,""));let f=ct(l);u!==null&&(p(this,z)[u]=f),a===null?a=s=f:(s.appendChild(f),s=f)}return{start:a,leaf:s}}parseComment(i){p(this,C).append(i.cloneNode(!0));let a=i.textContent.split(`
`);for(let s of a){if(s=s.trim(),s==="")continue;let l=s.substring(1).trim();switch(s.substring(0,1)){case"/":let u=this.createElementTree(l);p(this,$).appendChild(u.start),v(this,K,u.start),v(this,H,v(this,C,u.leaf)),v(this,T,O({},ee));break;case"!":let f=l.trim().split(" ",1).join(),h=je(l,"$"),c=document.querySelector(`template[id='${f}']`);if(c===null){console.error("<template id='",f,"'> not found. Selected in ",i);break}let o=document.createElement("div"),d=c.content.firstElementChild.outerHTML.replace(/\$\{(.*?)(\?(.*?))?\}/gi,(g,j,ge,mt)=>typeof h[j]!="undefined"?h[j]:mt);d=d.replace(/--([a-z\-]+)=/ig,(g,j)=>j+"="),o.innerHTML=d,p(this,C).append(o);for(let g of o.querySelectorAll("script")){let j={};g.hasAttribute("src")&&(j={src:g.getAttribute("src")});let ge=(0,M.ka_create_element)("script",j);ge.append(document.createTextNode(g.textContent)),g.parentElement.replaceChild(ge,g)}let _=o.querySelectorAll("[attach]");for(let g of _)g.getAttribute("attach")===""?(v(this,C,g),v(this,H,g)):p(this,z)[g.getAttribute("attach")]=g;_.length===0&&console.warn("Template has no attach point",c,o);break;case">":let A=this.createElementTree(l);p(this,H).appendChild(A.start),v(this,C,A.leaf);break;case"~":let[q,..._t]=l.split("=>"),pt=Oe(_t.join(":"));p(this,T)[q]={attrs:pt,line:s};break;case"?":let J=null;if(l.startsWith("\xA7")){if(J=p(this,z)[l.substring(1)],!R(J)){console.error("Cannot select reference: '"+s+"': Not found");break}}else if(J=p(this,K).querySelector(l),J===null){console.error(`Query Element '${l}': not found in `,i,"in",p(this,$));break}v(this,H,v(this,C,J));break;case"#":case"*":break;default:throw console.error("Cannot parse sequence: "+s+" of block",i),"Cannot parse sequence: "+s}}}applyAttMap(i){let a=document.createElement("div");a.append(i);for(let s in p(this,T))try{let l=a.querySelectorAll(s);for(let u of Array.from(l))for(let f in p(this,T)[s].attrs)u.setAttribute(f,p(this,T)[s].attrs[f])}catch(l){console.error("Cannot evaluate: '"+p(this,T)[s].line+"' - ",l);continue}}connectedCallback(){return m(this,null,function*(){yield(0,M.ka_dom_ready)(),yield(0,M.ka_sleep)(1),this.hasAttribute("default")||(yield(0,M.ka_sleep)(1)),v(this,T,O({},ee)),v(this,$,v(this,K,v(this,C,v(this,H,(0,M.ka_create_element)("div",{class:this.getAttribute("class")+" loading"},[]))))),this.parentElement.insertBefore(p(this,$),this.nextElementSibling);for(let i of Array.from(this.childNodes)){if(i instanceof Comment){this.parseComment(i);continue}let a=i.cloneNode(!0);this.applyAttMap(a),p(this,C).append(a)}this.hasAttribute("default")&&(ee=p(this,T),console.debug("Register default attribute map: ",ee,"from",this)),yield(0,M.ka_sleep)(10),p(this,$).classList.remove("loading"),this.classList.remove("loading"),this.style.display="none"})}disconnectedCallback(){return m(this,null,function*(){})}};H=new WeakMap,C=new WeakMap,K=new WeakMap,$=new WeakMap,z=new WeakMap,T=new WeakMap,me=w([(0,M.customElement)("leu-content")],me);var W=y(X(),1),Y=y(b(),1);var F=class extends HTMLElement{constructor(){super();this._oldHash=null;this.progressBarE=null;this.content=null;this.titleE=null;this.nextE=null;this.backE=null;this.curDivE=null;let i=this}_selectElement(i){let a=this.content.children[i];this.curDivE=a,this.progressBarE.ariaValueMin=0,this.progressBarE.ariaValueMax=this.content.childElementCount,this.progressBarE.ariaValueNow=i+1,this.progressBarE.style.width=(i+1)/this.content.childElementCount*100+"%",this.titleE.textContent=a.getAttribute("data-title"),a.classList.remove(ye.config.switcher.hiddenClass),this.nextE.hidden=!1,i+1===this.content.childElementCount&&(this.nextE.hidden=!0),this.backE.hidden=!1,i===0&&(this.backE.hidden=!0)}_routeChange(){return m(this,null,function*(){let i=window.location.hash.substring(1),a=!1;for(let s=0;s<this.content.children.length;s++){let l=this.content.children[s];console.log("scan",l),l.classList.add(ye.config.switcher.hiddenClass),(l.id===i||this.hasAttribute("show-all"))&&(this._selectElement(s),a=!0)}a===!1&&this._selectElement(0)})}next(i=null){return m(this,null,function*(){if(yield(0,Y.ka_sleep)(500),this.curDivE.nextElementSibling!==null)return history.pushState(null,null,"#"+this.curDivE.nextElementSibling.id),i!==null&&i.preventDefault(),console.log("next"),!1})}backClickCb(i){return history.pushState(null,null,"#"+this.curDivE.previousElementSibling.id),i.preventDefault(),!1}_locationListener(){return m(this,null,function*(){window.location.hash!==this._oldHash&&(this._oldHash=window.location.hash,yield this._routeChange(),this.hidden=!1)})}connectedCallback(){return m(this,null,function*(){yield(0,Y.ka_dom_ready)(),this.progressBarE=(0,W.ka_query_selector)("[data-leu-role='progress-bar']",this,"data-leu-role='progress-bar'"),this.content=(0,W.ka_query_selector)("[data-leu-role='content']",this,"data-leu-role='progress-bar'"),this.titleE=(0,W.ka_query_selector)("[data-leu-role='title']",this,"data-leu-role='title'"),this.nextE=(0,W.ka_query_selector)("[data-leu-role='next-btn']",this,"data-leu-role='next-btn'"),this.backE=(0,W.ka_query_selector)("[data-leu-role='back-btn']",this,"data-leu-role='back-btn'"),this.backE.addEventListener("click",i=>this.backClickCb(i)),this.nextE.addEventListener("click",i=>this.next(i)),window.setInterval(()=>this._locationListener(),200),window.setInterval(()=>{this.style.height=this.curDivE.offsetHeight+"px"},500),window.addEventListener("pushstate",()=>{console.log("State pushed")})})}};F=w([(0,Y.customElement)("leu-switcher")],F);var dt=y(b(),1),ft=y(ae(),1);var Z,ke=class extends HTMLElement{constructor(){super(...arguments);x(this,Z,null)}evalIf(i=null){(0,ft.ka_eval)(this.dataset.if,this,i,{})===!0?this.classList.remove(Leu.config.switcher.hiddenClass):this.classList.remove(Leu.config.switcher.hiddenClass)}connectedCallback(){this.style.display="contents",v(this,Z,i=>this.evalIf(i)),document.addEventListener("click",p(this,Z)),this.evalIf()}disconnectedCallback(){document.removeEventListener("click",p(this,Z))}};Z=new WeakMap,ke=w([(0,dt.customElement)("leu-show")],ke);var G=y(b(),1),ht=y(X(),1);var be=y(b(),1);var Q={},ve=class extends HTMLElement{connectedCallback(){return m(this,null,function*(){this.style.display="none",yield(0,be.ka_dom_ready)(),R(this.dataset.value)&&(Q[this.dataset.name]=this.dataset.value),R(this.dataset.increment)&&(R(Q[this.dataset.name])||(Q[this.dataset.name]=0),Q[this.dataset.name]++);let t=new Comment(this.outerHTML);this.replaceWith(t)})}};ve=w([(0,be.customElement)("leu-var")],ve);var we=class extends HTMLElement{connectedCallback(){return m(this,null,function*(){this.style.display="contents",yield(0,G.ka_dom_ready)(),yield(0,G.ka_sleep)(1);let t=this.dataset.tplId,i=(0,ht.ka_query_selector)("template[id='"+t+"']",null,"leu-use: template with id '"+t+"' not found"),a=O(O({},Q),this.dataset);console.log(a);let s=i.content.firstElementChild.outerHTML.replace(/\$\{(.*?)(\?(.*?))?}/gi,(c,o,d,_)=>typeof a[o]!="undefined"?a[o]:(typeof _=="undefined"&&console.error(`[<leu-use>] Data-Attribute missing: 'data-${o}' on <template id="${t}>" called by <leu-use></leu-use>`,this),_));s=s.replace(/([a-z\-]+)--=(["'])/ig,(c,o,d)=>o+"="+d);let l=this.innerHTML,u=document.createElement("div");u.innerHTML=s;let f=u.querySelector("*[attach]");f!==null&&(f.innerHTML=l),u.childNodes.forEach(c=>this.parentElement.insertBefore(c,this.nextElementSibling));let h=new Comment(this.outerHTML);this.replaceWith(h)})}};we=w([(0,G.customElement)("leu-use")],we);var ye={config:{switcher:{hiddenClass:"visually-hidden"}},findParent:qe,Switcher:F,SmoothScroll:he};globalThis.Leu=ye;})();
