(()=>{var bt=Object.create;var ne=Object.defineProperty;var Be=Object.getOwnPropertyDescriptor;var vt=Object.getOwnPropertyNames,Ve=Object.getOwnPropertySymbols,gt=Object.getPrototypeOf,Ie=Object.prototype.hasOwnProperty,wt=Object.prototype.propertyIsEnumerable;var Ne=(n,t,i)=>t in n?ne(n,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[t]=i,q=(n,t)=>{for(var i in t||={})Ie.call(t,i)&&Ne(n,i,t[i]);if(Ve)for(var i of Ve(t))wt.call(t,i)&&Ne(n,i,t[i]);return n};var b=(n,t)=>()=>(t||n((t={exports:{}}).exports,t),t.exports);var Et=(n,t,i,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of vt(t))!Ie.call(n,s)&&s!==i&&ne(n,s,{get:()=>t[s],enumerable:!(a=Be(t,s))||a.enumerable});return n};var k=(n,t,i)=>(i=n!=null?bt(gt(n)):{},Et(t||!n||!n.__esModule?ne(i,"default",{value:n,enumerable:!0}):i,n));var w=(n,t,i,a)=>{for(var s=a>1?void 0:a?Be(t,i):t,l=n.length-1,u;l>=0;l--)(u=n[l])&&(s=(a?u(t,i,s):u(s))||s);return a&&s&&ne(t,i,s),s};var Pe=(n,t,i)=>{if(!t.has(n))throw TypeError("Cannot "+i)};var p=(n,t,i)=>(Pe(n,t,"read from private field"),i?i.call(n):t.get(n)),L=(n,t,i)=>{if(t.has(n))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(n):t.set(n,i)},y=(n,t,i,a)=>(Pe(n,t,"write to private field"),a?a.call(n,i):t.set(n,i),i);var m=(n,t,i)=>new Promise((a,s)=>{var l=h=>{try{f(i.next(h))}catch(c){s(c)}},u=h=>{try{f(i.throw(h))}catch(c){s(c)}},f=h=>h.done?a(h.value):Promise.resolve(h.value).then(l,u);f((i=i.apply(n,t)).next())});var De=b(V=>{"use strict";var Ct=V&&V.__awaiter||function(n,t,i,a){function s(l){return l instanceof i?l:new i(function(u){u(l)})}return new(i||(i=Promise))(function(l,u){function f(o){try{c(a.next(o))}catch(d){u(d)}}function h(o){try{c(a.throw(o))}catch(d){u(d)}}function c(o){o.done?l(o.value):s(o.value).then(f,h)}c((a=a.apply(n,t||[])).next())})};Object.defineProperty(V,"__esModule",{value:!0});V.ka_sleep=void 0;function Tt(n){return Ct(this,void 0,void 0,function*(){return new Promise(t=>{window.setTimeout(()=>t(),n)})})}V.ka_sleep=Tt});var Re=b(ie=>{"use strict";Object.defineProperty(ie,"__esModule",{value:!0});ie.ka_create_element=void 0;function Mt(n,t=null,i=null,a=null){let s=document.createElement(n);t===null&&(t={});for(let l in t)s.setAttribute(l,t[l]);if(Array.isArray(i))for(let l of i)s.appendChild(l);return a!==null&&a.appendChild(s),s}ie.ka_create_element=Mt});var Ke=b(N=>{"use strict";var Lt=N&&N.__awaiter||function(n,t,i,a){function s(l){return l instanceof i?l:new i(function(u){u(l)})}return new(i||(i=Promise))(function(l,u){function f(o){try{c(a.next(o))}catch(d){u(d)}}function h(o){try{c(a.throw(o))}catch(d){u(d)}}function c(o){o.done?l(o.value):s(o.value).then(f,h)}c((a=a.apply(n,t||[])).next())})};Object.defineProperty(N,"__esModule",{value:!0});N.ka_dom_ready=void 0;function xt(){return Lt(this,void 0,void 0,function*(){return new Promise(n=>{if(document.readyState==="complete"||document.readyState==="interactive")return n("loaded");document.addEventListener("DOMContentLoaded",()=>n("DOMContentLoaded"))})})}N.ka_dom_ready=xt});var ze=b(ae=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0});ae.customElement=void 0;function At(n){return function(t){return console.debug("registering custom element",t,n),customElements.define(n,t),t}}ae.customElement=At});var le=b((exports,module)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.ka_eval=void 0;function ka_eval(stmt,__scope,e,__refs){stmt.endsWith(";")&&(stmt=stmt.slice(0,-1));let reserved=["var","null","let","const","function","class","in","of","for","true","false","await","$this"],r="var $this = e;";for(let n in __scope)if(reserved.indexOf(n)===-1){if(n.indexOf("-")!==-1)throw console.error(`Invalid scope key '${n}': Cannot contain - in scope:`,__scope),`eval() failed: Invalid scope key: '${n}': Cannot contain minus char '-'`;r+=`var ${n} = __scope['${n}'];`}typeof __scope.$scope>"u"&&(r+="var $scope = __scope;");try{return eval(r+"("+stmt+")")}catch(n){throw console.error("cannot eval() stmt: '"+stmt+"': "+n," on element ",e,n,"(context:",__scope,")"),"eval('"+stmt+"') failed: "+n}}exports.ka_eval=ka_eval});var Ce=b(re=>{"use strict";Object.defineProperty(re,"__esModule",{value:!0});re.ka_elwalk=void 0;function We(n,t,i=!1,a=!1){if(Array.isArray(n)&&(n.children=n),!(typeof n.children>"u")){if(a&&n instanceof HTMLElement&&t(n)===!1)return!1;for(let s of n.children)t(s)!==!1&&i&&typeof s.children<"u"&&We(s,t,i)}}re.ka_elwalk=We});var Fe=b(se=>{"use strict";Object.defineProperty(se,"__esModule",{value:!0});se.ka_str_to_camel_case=void 0;function $t(n){return n.replace(/(?:^\w|[A-Z]|\b\w)/g,(t,i)=>i===0?t.toLowerCase():t.toUpperCase()).replace(/[^a-zA-Z0-9]+/g,"")}se.ka_str_to_camel_case=$t});var Ze=b(B=>{"use strict";var Ht=B&&B.__awaiter||function(n,t,i,a){function s(l){return l instanceof i?l:new i(function(u){u(l)})}return new(i||(i=Promise))(function(l,u){function f(o){try{c(a.next(o))}catch(d){u(d)}}function h(o){try{c(a.throw(o))}catch(d){u(d)}}function c(o){o.done?l(o.value):s(o.value).then(f,h)}c((a=a.apply(n,t||[])).next())})};Object.defineProperty(B,"__esModule",{value:!0});B.ka_apply=void 0;var x=le(),oe=Fe();function Ye(n,t,i=!1){typeof n=="string"&&(n=KaToolsV1.querySelector(n));let a={textcontent:"textContent",htmlcontent:"innerHTML",innerhtml:"innerHTML"};for(let s of n.getAttributeNames()){if(!s.startsWith("ka."))continue;let l=n.getAttribute(s),u=s.split(".")[1],f=s.split(".")[2];typeof f>"u"&&(f=null);let h=function(o,d,_,A){typeof o._ka_on>"u"&&(o._ka_on={}),typeof o._ka_on[d]>"u"&&o.addEventListener(d,S=>o._ka_on[d](S)),o._ka_on[d]=S=>Ht(this,void 0,void 0,function*(){return A.$event=S,typeof _=="function"?_(S,o,A):(0,x.ka_eval)(_,A,o)})};if(u==="on"){let o=Object.assign({$scope:t},t);if(f!==null)h(n,f,l,o);else{let d=KaToolsV1.eval(l,o,n);for(let _ in d)h(n,_,d[_],o)}continue}let c=null;switch(typeof l<"u"&&typeof l!==null&&l!==""&&(c=(0,x.ka_eval)(l,t,n)),u){case"ref":typeof t.$ref>"u"&&(t.$ref={}),c!==null&&(t.$ref[c]=n),t.$ref.$last=n;break;case"classlist":if(f!==null){c===!0?n.classList.add(f):n.classList.remove(f);break}for(let d in c)c[d]===!0?n.classList.add(d):n.classList.remove(d);break;case"style":if(f!==null){let d=c;typeof d=="number"&&["left","top","height","width","bottom","right","line-height","font-size"].indexOf(f)!==-1&&(d=d+"px"),n.style[(0,oe.ka_str_to_camel_case)(f)]=d;break}for(let d in c){let _=c[d];typeof _=="number"&&["left","top","height","width","bottom","right","line-height","font-size"].indexOf(d)!==-1&&(_=_+"px"),n.style[(0,oe.ka_str_to_camel_case)(d)]=_}break;case"bindarray":if(f==="default")continue;if(typeof c>"u"&&n.hasAttribute("ka.bind.default")&&(t=Object.assign({$scope:t},t),t=Object.assign(Object.assign({$scope:t},t),{__curVal:(0,x.ka_eval)(n.getAttribute("ka.bind.default"),t,n)}),(0,x.ka_eval)(`${l} = __curVal`,t,n),c=t.__curVal),!Array.isArray(c)){console.error("kap:bindarr: Not an array!",c,n);return}c.indexOf(n.value)===-1?n.checked=!1:n.checked=!0,typeof n._kap_bind>"u"&&(n.addEventListener("change",d=>{let _=(0,x.ka_eval)(l,t,n);_.indexOf(n.value)===-1&&n.checked&&_.push(n.value),_.indexOf(n.value)!==-1&&!n.checked&&(_=_.filter(A=>A!==n.value)),t=Object.assign(Object.assign({$scope:t},t),{__curVal:_}),(0,x.ka_eval)(`${l} = __curVal`,t,n),t.$on&&t.$on.change&&t.$on.change(d)}),n._kap_bind=!0);break;case"bind":if(f==="default")continue;typeof c>"u"&&n.hasAttribute("ka.bind.default")&&(t=Object.assign({$scope:t},t),t=Object.assign(Object.assign({$scope:t},t),{__curVal:(0,x.ka_eval)(n.getAttribute("ka.bind.default"),t,n)}),(0,x.ka_eval)(`${l} = __curVal`,t,n),c=t.__curVal),n.type==="checkbox"||n.type==="radio"?n.hasAttribute("value")?c===n.getAttribute("value")?n.checked=!0:n.checked=!1:c===!0?n.checked=!0:n.checked=!1:n.value=typeof c<"u"?c:"",typeof n._kap_bind>"u"&&(n.addEventListener("change",d=>{let _=null;if(n.type==="checkbox"||n.type==="radio")if(n.hasAttribute("value")){if(n.checked===!1)return;_=n.getAttribute("value")}else _=n.checked;else _=n.value;t=Object.assign(Object.assign({$scope:t},t),{__curVal:_}),(0,x.ka_eval)(`${l} = __curVal`,t,n),t.$on&&t.$on.change&&t.$on.change(d)}),n.addEventListener("keyup",d=>{t=Object.assign(Object.assign({$scope:t},t),{__curVal:n.value}),(0,x.ka_eval)(`${l} = __curVal`,t,n),t.$on&&t.$on.change&&t.$on.change(d)}),n._kap_bind=!0);break;case"options":let o=n.value;n.innerHTML="";for(let d in c)isNaN(d)?n.appendChild(new Option(c[d],d)):typeof c[d].text<"u"?n.appendChild(new Option(c[d].text,c[d].value)):n.appendChild(new Option(c[d],c[d]));o!==null&&(n.value=o);break;case"attr":if(f!==null){c===null||c===!1?n.removeAttribute(f):n.setAttribute(f,c);break}for(let d in c)c[d]===null||c[d]===!1?n.removeAttribute(d):n.setAttribute(d,c[d]);break;case"prop":if(f!==null){n[(0,oe.ka_str_to_camel_case)(f)]=c;break}for(let d in c)n[(0,oe.ka_str_to_camel_case)(d)]=c[d];break;default:typeof a[u]<"u"&&(u=a[u]),typeof n[u]>"u"&&console.warn("apply(): trying to set undefined property ",u,"on element",n),n[u]=c;break}}if(i)for(let s of n.children)Ye(s,t,i)}B.ka_apply=Ye});var U=b(ue=>{"use strict";Object.defineProperty(ue,"__esModule",{value:!0});ue.ka_query_selector=void 0;function Ot(n,t,i){typeof i>"u"&&(i=`querySelector '${n}' not found`),(typeof t>"u"||t===null)&&(t=document);let a=t.querySelectorAll(n);if(a.length===0)throw console.warn(i,"on parent: ",t),i;return a[0]}ue.ka_query_selector=Ot});var Te=b(de=>{"use strict";Object.defineProperty(de,"__esModule",{value:!0});de.ka_templatify=void 0;var jt=U(),qt=Ce();window._ka_el_idx=0;function ce(n,t=!0){if(typeof n=="string"&&(n=(0,jt.ka_query_selector)(n)),!(n instanceof Node))throw console.error("[ka-templatify] Parameter 1 is not a html element: ",n),`[ka-templify] Parameter 1 is not a html element: ${n}`;if(t){let a=document.createElement("template");return a.setAttribute("_kaidx",(window._ka_el_idx++).toString()),a.innerHTML=n.innerHTML.replace(/\[\[(.*?)\]\]/g,(s,l)=>`<span ka.textContent="${l}"></span>`),ce(a.content,!1),a}n instanceof HTMLTemplateElement&&(n=n.content);let i=(a,s,l)=>{let u=document.createElement("template");u.setAttribute("_kaidx",(window._ka_el_idx++).toString());let f=a.cloneNode(!0);return f.removeAttribute(s),u.content.append(f),u.setAttribute(s,l),a.replaceWith(u),u};(0,qt.ka_elwalk)(n,a=>{if(!(a instanceof HTMLElement))return;let s=null;for(let l of a.getAttributeNames()){if(l==="ka.for"){s=i(a,"ka.for",a.getAttribute("ka.for")),ce(s,!1);break}if(l==="ka.if"){s=i(a,"ka.if",a.getAttribute("ka.if")),ce(s,!1);break}}},!0,!1)}de.ka_templatify=ce});var Qe=b(I=>{"use strict";var St=I&&I.__awaiter||function(n,t,i,a){function s(l){return l instanceof i?l:new i(function(u){u(l)})}return new(i||(i=Promise))(function(l,u){function f(o){try{c(a.next(o))}catch(d){u(d)}}function h(o){try{c(a.throw(o))}catch(d){u(d)}}function c(o){o.done?l(o.value):s(o.value).then(f,h)}c((a=a.apply(n,t||[])).next())})};Object.defineProperty(I,"__esModule",{value:!0});I.ka_load_html=void 0;function Vt(n){return St(this,void 0,void 0,function*(){let t=document.createElement("template"),i=yield fetch(n);if(!i.ok)throw console.error(`[loadHtml] failed to load '${n}'`),`[loadHtml] failed to load '${n}'`;let a=yield i.text();return t.innerHTML=a,t})}I.ka_load_html=Vt});var Ge=b(P=>{"use strict";var Nt=P&&P.__awaiter||function(n,t,i,a){function s(l){return l instanceof i?l:new i(function(u){u(l)})}return new(i||(i=Promise))(function(l,u){function f(o){try{c(a.next(o))}catch(d){u(d)}}function h(o){try{c(a.throw(o))}catch(d){u(d)}}function c(o){o.done?l(o.value):s(o.value).then(f,h)}c((a=a.apply(n,t||[])).next())})};Object.defineProperty(P,"__esModule",{value:!0});P.RemoteTemplate=void 0;var Bt=Qe(),Me=class{constructor(t){this.url=t,this.tpl=null}load(){return Nt(this,void 0,void 0,function*(){return this.tpl===null&&(this.tpl=yield(0,Bt.ka_load_html)(this.url)),this.tpl})}};P.RemoteTemplate=Me});var Je=b(D=>{"use strict";var Le=D&&D.__awaiter||function(n,t,i,a){function s(l){return l instanceof i?l:new i(function(u){u(l)})}return new(i||(i=Promise))(function(l,u){function f(o){try{c(a.next(o))}catch(d){u(d)}}function h(o){try{c(a.throw(o))}catch(d){u(d)}}function c(o){o.done?l(o.value):s(o.value).then(f,h)}c((a=a.apply(n,t||[])).next())})};Object.defineProperty(D,"__esModule",{value:!0});D.KaCustomElement=void 0;var It=Te(),Pt=Ae(),Dt=U(),Rt=Ge(),xe=class extends HTMLElement{constructor(t){super(t),this.__tpl=null,this.__isConnected=!1}get $tpl(){return this.__tpl}isConnected(){return this.isConnected}connected(t,i){return Le(this,void 0,void 0,function*(){console.warn("connected() method not overridden in",this)})}connectedCallback(){return Le(this,void 0,void 0,function*(){let t=this.constructor.__callback;if(t===null||t.bind(this),this.constructor.__tpl!==null){let i=this.constructor.__tpl;i instanceof Rt.RemoteTemplate&&(i=yield i.load());let a=(0,It.ka_templatify)(i);this.constructor.__options.shadowDom===!0?this.attachShadow(this.constructor.__options.shadowDomOptions).appendChild(a):this.appendChild(a),this.__tpl=new Pt.KaTemplate(a)}if(this.constructor.__options.waitEvent!==null){let i=this.constructor.__options.waitEvent.split("@"),a=i[0],s=document;i.length===2&&(s=(0,Dt.ka_query_selector)(i[1])),s.addEventListener(a,l=>Le(this,void 0,void 0,function*(){t(this.$tpl,this),this.__isConnected=!0}));return}if(t===null){yield this.connected(this.$tpl,this),this.__isConnected=!0;return}t(this.$tpl,this),this.__isConnected=!0})}};D.KaCustomElement=xe});var Ae=b(fe=>{"use strict";Object.defineProperty(fe,"__esModule",{value:!0});fe.KaTemplate=void 0;var Xe=le(),Kt=Ce(),zt=Ze(),Wt=Je(),$e=class{constructor(t){this.template=t,typeof this.template.__kachilds>"u"&&(this.template.__kachilds=[]),typeof this.template.__kasibling>"u"&&(this.template.__kasibling=this.template.nextElementSibling),this.__renderCount=0,this.$scope={}}_error(t){throw console.error(`[ka-template] ${t} on element`,this.template),`[ka-template] ${t} on element`+this.template}_appendTemplate(){let t=this.template.content,i=[];for(let a of t.children)a=a.cloneNode(!0),a._ka_maintained_by=this.template.getAttribute("_kaidx"),i.push(a),this.template.parentNode.insertBefore(a,this.template.__kasibling);this.template.__kachilds.push(i)}_removeLastChild(){if(this.template.__kachilds.length===0)return;let t=this.template.__kachilds[this.template.__kachilds.length-1];for(let i of t)this.template.parentElement.removeChild(i);this.template.__kachilds.length=this.template.__kachilds.length-1}_renderFor(t,i){let a=i.match(/^(let)?\s*(?<target>.+)\s+(?<type>of|in|repeat)\s+(?<select>.+)$/);a===null&&this._error(`Can't parse ka.for='${i}'`);let s=(0,Xe.ka_eval)(a.groups.select,t,this.template);a.groups.type==="repeat"&&(typeof s!="number"&&this._error(`Error ka.for='${i}': Selected val must be number in repeat loop`),s=new Array(s).fill(null));let l=0;for(let u in s){let f=Object.assign({$scope:t},t);f[a.groups.target]=u,a.groups.type==="of"&&(f[a.groups.target]=s[u]),this.template.__kachilds.length<l+1&&this._appendTemplate(),this._maintain(f,this.template.__kachilds[l],l),l++}for(let u=l;u<this.template.__kachilds.length;)this._removeLastChild()}_maintain(t,i,a=0){for(let s of i)s._ka_for_index=a,(0,Kt.ka_elwalk)(s,l=>{if(l instanceof HTMLTemplateElement)return new this.constructor(l).render(t),!1;if(typeof l._ka_maintained_by<"u"&&l._ka_maintained_by!==this.template.getAttribute("_kaidx")||((0,zt.ka_apply)(l,t),l instanceof HTMLElement&&(l.hasAttribute("ka.stop")||l instanceof Wt.KaCustomElement)))return!1},!0,!0)}_renderIf(t,i){(0,Xe.ka_eval)(i,t,this.template)===!0?(this.template.__kachilds.length===0&&this._appendTemplate(),this._maintain(t,this.template.__kachilds[0])):this._removeLastChild()}dispose(){for(;this.template.__kachilds.length>0;)this._removeLastChild()}render(t=null){t===null&&(t=this.$scope),this.$scope=t,this.__renderCount++,this.template.hasAttribute("ka.for")?this._renderFor(t,this.template.getAttribute("ka.for")):this.template.hasAttribute("ka.if")?this._renderIf(t,this.template.getAttribute("ka.if")):(typeof this.template._ka_active>"u"&&(this._appendTemplate(),this.template._ka_active=!0),this._maintain(t,this.template.__kachilds))}isFirstRender(){return this.__renderCount===1}};fe.KaTemplate=$e});var He=b(he=>{"use strict";Object.defineProperty(he,"__esModule",{value:!0});he.ka_html=void 0;function Ft(n){let t=document.createElement("template");return t.innerHTML=n,t}he.ka_html=Ft});var et=b(R=>{"use strict";var Ue=R&&R.__awaiter||function(n,t,i,a){function s(l){return l instanceof i?l:new i(function(u){u(l)})}return new(i||(i=Promise))(function(l,u){function f(o){try{c(a.next(o))}catch(d){u(d)}}function h(o){try{c(a.throw(o))}catch(d){u(d)}}function c(o){o.done?l(o.value):s(o.value).then(f,h)}c((a=a.apply(n,t||[])).next())})};Object.defineProperty(R,"__esModule",{value:!0});R.KaHtmlElement=void 0;var Yt=Ae(),Zt=Te(),Qt=He(),Oe=class extends HTMLElement{constructor(t=null){super(),this.shadowRootInit=t,this.addEventListener("load",i=>console.log(i))}connectedCallback(){return Ue(this,void 0,void 0,function*(){let t;if(typeof this.html=="function"){let a=this.html;t=yield a(this)}typeof t=="string"&&(t=(0,Qt.ka_html)(t));let i=this;if(this.shadowRootInit!==null&&(i=this.attachShadow(this.shadowRootInit)),this.html!==null){let a=(0,Zt.ka_templatify)(t);this.$tpl=new Yt.KaTemplate(a),i.appendChild(a)}this.connected()})}disconnectedCallback(){return Ue(this,void 0,void 0,function*(){this.disconnected()})}};R.KaHtmlElement=Oe});var g=b(E=>{"use strict";var Gt=E&&E.__createBinding||(Object.create?function(n,t,i,a){a===void 0&&(a=i);var s=Object.getOwnPropertyDescriptor(t,i);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(n,a,s)}:function(n,t,i,a){a===void 0&&(a=i),n[a]=t[i]}),ee=E&&E.__exportStar||function(n,t){for(var i in n)i!=="default"&&!Object.prototype.hasOwnProperty.call(t,i)&&Gt(t,n,i)};Object.defineProperty(E,"__esModule",{value:!0});E.ka_dom_ready=void 0;ee(De(),E);ee(Re(),E);var Jt=Ke();Object.defineProperty(E,"ka_dom_ready",{enumerable:!0,get:function(){return Jt.ka_dom_ready}});ee(ze(),E);ee(et(),E);ee(He(),E)});var tt=k(g(),1);var _e=class{constructor(t=86){window.addEventListener("hashchange",i=>m(this,null,function*(){console.log(i),i.preventDefault(),yield(0,tt.ka_sleep)(1);let a=document.getElementById(window.location.hash.slice(1));if(a===null)return;let s=a.getBoundingClientRect().top+window.scrollY-t;console.log("scrollto",a,window.location.hash,a.getBoundingClientRect().top,s),window.scrollTo({top:s,behavior:"smooth"})}))}};var nt=k(g(),1),it=k(g(),1),at=k(g(),1),lt=k(g(),1);var pe=class extends nt.KaHtmlElement{constructor(){super(...arguments);this.html=()=>m(this,null,function*(){let i=this.innerHTML;return this.innerHTML="",i})}connected(){return m(this,null,function*(){yield(0,at.ka_dom_ready)(),this.style.display="contents";let i={elements:[]};document.querySelectorAll("[data-leu-nav]").forEach(a=>{i.elements.push({el:a,title:a.getAttribute("data-leu-nav"),id:a.id,active:!1})}),window.addEventListener("scroll",()=>m(this,null,function*(){yield(0,lt.ka_sleep)(100);let a=!1;for(let s of i.elements)s.active=!1,s.el.getBoundingClientRect().top+window.scrollY+10>window.scrollY&&!a&&(a=!0,s.active=!0);this.$tpl.render()}),{passive:!0}),this.removeAttribute("hidden"),this.$tpl.render(i)})}disconnected(){return m(this,null,function*(){})}};pe=w([(0,it.customElement)("leu-data-nav")],pe);var rt=k(g(),1),st=k(g(),1),ot=k(g(),1),ut=k(g(),1);typeof window.LeuFormatConfig=="undefined"&&(window.LeuFormatConfig={h1:["fs-2","text-center","content-space-2"],h2:["fs-3","mt-5"],hr:["clearboth"],img:["float-start","w-lg-50","w-100","pt-2","pb-2","pe-4"]});var me=class extends rt.KaHtmlElement{constructor(){super(...arguments);this.html=null}connected(){return m(this,null,function*(){yield(0,ot.ka_dom_ready)(),yield(0,ut.ka_sleep)(1);let i=LeuFormatConfig;for(let l of this.getAttributeNames())i[l]=this.getAttribute(l).split(" ");for(let l in i)for(let u of Array.from(this.querySelectorAll(l))){let f=i[l];for(let h of f)u.classList.add(h)}let a=null,s=0;e:do{if(this.children.length<s+1)break;let l=this.children[s],u=l.querySelector("[container]");if(u!==null){a=u,s++;continue}if(a===null){s++;continue}a.append(l)}while(!0)})}disconnected(){return m(this,null,function*(){})}};me=w([(0,st.customElement)("leu-format")],me);var M=k(g(),1);var ct=k(g(),1);function dt(n){let t={$:{},"@":{}},i=new RegExp("([@$])[^@^$]+","gi");return n.replace(i,(a,s)=>{if(a=a.substring(1),a.indexOf("=")===-1&&s==="@")typeof t[s].class=="undefined"&&(t[s].class=""),t[s].class+=" "+a,t[s].class=t[s].class.trim();else{let l=a.split("=",2);t[s][l[0]]=l[1]}return""}),t}function Xt(n,t="@"){let i={},a=new RegExp(`\\${t}[^${t}]+`,"gi");return n.replace(a,s=>{if(s=s.substring(1),s.indexOf("=")===-1)typeof i.class=="undefined"&&(i.class=""),i.class+=" "+s,i.class=i.class.trim();else{let l=s.split("=",2);i[l[0]]=l[1]}return""}),i}function je(n){return Xt(n,"@")}function ft(n){let t=n.trim(),i="div";t=t.replace(/^[a-z0-9_\:\-]+/ig,l=>(i=l,""));let a=je(t);return(0,ct.ka_create_element)(i,a)}function qe(n,t){return t instanceof n?t:t.parentElement===null?null:qe(n,t.parentElement)}function K(n){return!(typeof n=="undefined"||n===null)}var te={},H,C,z,O,W,F,T,ye=class extends HTMLElement{constructor(){super(...arguments);L(this,H,null);L(this,C,null);L(this,z,null);L(this,O,null);L(this,W,null);L(this,F,new Map);L(this,T,q({},te))}createElementTree(i){let a=null,s=null;for(let l of i.split(">")){let u=null;l=l.replace(/§([a-z0-9_\-]+)/,(h,c)=>(u=c,""));let f=ft(l);u!==null&&(p(this,F)[u]=f),a===null?a=s=f:(s.appendChild(f),s=f)}return{start:a,leaf:s}}parseComment(i){p(this,C).append(i.cloneNode(!0));let a=i.textContent.split(`
`);for(let s of a){if(s=s.trim(),s==="")continue;let l=s.substring(1).trim();switch(s.substring(0,1)){case"/":let u=this.createElementTree(l);p(this,W).appendChild(u.start),y(this,z,u.start),y(this,H,y(this,C,u.leaf)),y(this,T,q({},te));break;case"!":let f=l.trim().split(" ",1).join(),h=dt(l),c=document.querySelector(`template[id='${f}']`);if(c===null){console.error("<template id='",f,"'> not found. Selected in ",i);break}let o=document.createElement("div");if(h["@"].length===0)o.style.display="contents";else for(let v in h["@"])o.setAttribute(v,h["@"][v]);let d=c.content.firstElementChild.outerHTML.replace(/\$\{(.*?)(\?(.*?))?\}/gi,(v,j,Ee,kt)=>typeof h.$[j]!="undefined"?h.$[j]:kt);d=d.replace(/--([a-z\-]+)=/ig,(v,j)=>j+"="),o.innerHTML=d,p(this,C).append(o);for(let v of o.querySelectorAll("script")){let j={};v.hasAttribute("src")&&(j={src:v.getAttribute("src")});let Ee=(0,M.ka_create_element)("script",j);Ee.append(document.createTextNode(v.textContent)),v.parentElement.replaceChild(Ee,v)}let _=o.querySelectorAll("[attach]");for(let v of _)v.getAttribute("attach")===""?(y(this,C,v),y(this,H,v)):p(this,F)[v.getAttribute("attach")]=v;_.length===0&&console.warn("Template has no attach point",c,o);break;case">":let A=this.createElementTree(l);p(this,H).appendChild(A.start),y(this,C,A.leaf);break;case"~":let[S,...mt]=l.split("=>"),yt=je(mt.join(":"));p(this,T)[S]={attrs:yt,line:s};break;case"?":let $=null,Se=!1;if(l.indexOf("***")!==-1&&(Se=!0,l=l.replace("***","")),l.startsWith("/"))$=p(this,O);else if(l.trim()==="\xA7\xA7")$=p(this,C);else if(l.startsWith("\xA7")){if($=p(this,F)[l.substring(1)],!K($)){console.error("Cannot select reference: '"+s+"': Not found in block",i);break}}else if($=p(this,z).querySelector(l),$===null){console.error(`Query Element '${l}': not found in `,i,"in",p(this,O));break}y(this,H,y(this,C,$)),Se&&y(this,W,$);break;case"#":case"*":break;default:throw console.error("Cannot parse sequence: "+s+" of block",i),"Cannot parse sequence: "+s}}}applyAttMap(i){let a=document.createElement("div");a.append(i);for(let s in p(this,T))try{let l=a.querySelectorAll(s);for(let u of Array.from(l))for(let f in p(this,T)[s].attrs)u.setAttribute(f,p(this,T)[s].attrs[f])}catch(l){console.error("Cannot evaluate: '"+p(this,T)[s].line+"' - ",l);continue}}connectedCallback(){return m(this,null,function*(){yield(0,M.ka_dom_ready)(),yield(0,M.ka_sleep)(1),this.hasAttribute("default")||(yield(0,M.ka_sleep)(1)),y(this,T,q({},te)),y(this,O,y(this,W,y(this,z,y(this,C,y(this,H,(0,M.ka_create_element)("div",{class:this.getAttribute("class")+" loading"},[])))))),this.parentElement.insertBefore(p(this,O),this.nextElementSibling);for(let i of Array.from(this.childNodes)){if(i instanceof Comment){this.parseComment(i);continue}let a=i.cloneNode(!0);i.remove(),this.applyAttMap(a),p(this,C).append(a)}this.hasAttribute("default")&&(te=p(this,T),console.debug("Register default attribute map: ",te,"from",this)),yield(0,M.ka_sleep)(10),p(this,O).classList.remove("loading"),this.classList.remove("loading"),this.style.display="none"})}disconnectedCallback(){return m(this,null,function*(){})}};H=new WeakMap,C=new WeakMap,z=new WeakMap,O=new WeakMap,W=new WeakMap,F=new WeakMap,T=new WeakMap,ye=w([(0,M.customElement)("leu-content")],ye);var Y=k(U(),1),Q=k(g(),1);var Z=class extends HTMLElement{constructor(){super();this._oldHash=null;this.progressBarE=null;this.content=null;this.titleE=null;this.nextE=null;this.backE=null;this.curDivE=null;let i=this}_selectElement(i){let a=this.content.children[i];this.curDivE=a,this.progressBarE.ariaValueMin=0,this.progressBarE.ariaValueMax=this.content.childElementCount,this.progressBarE.ariaValueNow=i+1,this.progressBarE.style.width=(i+1)/this.content.childElementCount*100+"%",this.titleE.textContent=a.getAttribute("data-title"),a.classList.remove(ke.config.switcher.hiddenClass),this.nextE.hidden=!1,i+1===this.content.childElementCount&&(this.nextE.hidden=!0),this.backE.hidden=!1,i===0&&(this.backE.hidden=!0)}_routeChange(){return m(this,null,function*(){let i=window.location.hash.substring(1),a=!1;for(let s=0;s<this.content.children.length;s++){let l=this.content.children[s];console.log("scan",l),l.classList.add(ke.config.switcher.hiddenClass),(l.id===i||this.hasAttribute("show-all"))&&(this._selectElement(s),a=!0)}a===!1&&this._selectElement(0)})}next(i=null){return m(this,null,function*(){if(yield(0,Q.ka_sleep)(500),this.curDivE.nextElementSibling!==null)return history.pushState(null,null,"#"+this.curDivE.nextElementSibling.id),i!==null&&i.preventDefault(),console.log("next"),!1})}backClickCb(i){return history.pushState(null,null,"#"+this.curDivE.previousElementSibling.id),i.preventDefault(),!1}_locationListener(){return m(this,null,function*(){window.location.hash!==this._oldHash&&(this._oldHash=window.location.hash,yield this._routeChange(),this.hidden=!1)})}connectedCallback(){return m(this,null,function*(){yield(0,Q.ka_dom_ready)(),this.progressBarE=(0,Y.ka_query_selector)("[data-leu-role='progress-bar']",this,"data-leu-role='progress-bar'"),this.content=(0,Y.ka_query_selector)("[data-leu-role='content']",this,"data-leu-role='progress-bar'"),this.titleE=(0,Y.ka_query_selector)("[data-leu-role='title']",this,"data-leu-role='title'"),this.nextE=(0,Y.ka_query_selector)("[data-leu-role='next-btn']",this,"data-leu-role='next-btn'"),this.backE=(0,Y.ka_query_selector)("[data-leu-role='back-btn']",this,"data-leu-role='back-btn'"),this.backE.addEventListener("click",i=>this.backClickCb(i)),this.nextE.addEventListener("click",i=>this.next(i)),window.setInterval(()=>this._locationListener(),200),window.setInterval(()=>{this.style.height=this.curDivE.offsetHeight+"px"},500),window.addEventListener("pushstate",()=>{console.log("State pushed")})})}};Z=w([(0,Q.customElement)("leu-switcher")],Z);var ht=k(g(),1),_t=k(le(),1);var G,be=class extends HTMLElement{constructor(){super(...arguments);L(this,G,null)}evalIf(i=null){(0,_t.ka_eval)(this.dataset.if,this,i,{})===!0?this.classList.remove(Leu.config.switcher.hiddenClass):this.classList.remove(Leu.config.switcher.hiddenClass)}connectedCallback(){this.style.display="contents",y(this,G,i=>this.evalIf(i)),document.addEventListener("click",p(this,G)),this.evalIf()}disconnectedCallback(){document.removeEventListener("click",p(this,G))}};G=new WeakMap,be=w([(0,ht.customElement)("leu-show")],be);var X=k(g(),1),pt=k(U(),1);var ge=k(g(),1);var J={},ve=class extends HTMLElement{connectedCallback(){return m(this,null,function*(){this.style.display="none",yield(0,ge.ka_dom_ready)(),K(this.dataset.value)&&(J[this.dataset.name]=this.dataset.value),K(this.dataset.increment)&&(K(J[this.dataset.name])||(J[this.dataset.name]=0),J[this.dataset.name]++);let t=new Comment(this.outerHTML);this.replaceWith(t)})}};ve=w([(0,ge.customElement)("leu-var")],ve);var we=class extends HTMLElement{connectedCallback(){return m(this,null,function*(){this.style.display="contents",yield(0,X.ka_dom_ready)(),yield(0,X.ka_sleep)(1);let t=this.dataset.tplId,i=(0,pt.ka_query_selector)("template[id='"+t+"']",null,"leu-use: template with id '"+t+"' not found"),a=q(q({},J),this.dataset);console.log(a);let s=i.content.firstElementChild.outerHTML.replace(/\$\{(.*?)(\?(.*?))?}/gi,(c,o,d,_)=>typeof a[o]!="undefined"?a[o]:(typeof _=="undefined"&&console.error(`[<leu-use>] Data-Attribute missing: 'data-${o}' on <template id="${t}>" called by <leu-use></leu-use>`,this),_));s=s.replace(/([a-z\-]+)--=(["'])/ig,(c,o,d)=>o+"="+d);let l=this.innerHTML,u=document.createElement("div");u.innerHTML=s;let f=u.querySelector("*[attach]");f!==null&&(f.innerHTML=l),u.childNodes.forEach(c=>this.parentElement.insertBefore(c,this.nextElementSibling));let h=new Comment(this.outerHTML);this.replaceWith(h)})}};we=w([(0,X.customElement)("leu-use")],we);var ke={config:{switcher:{hiddenClass:"visually-hidden"}},findParent:qe,Switcher:Z,SmoothScroll:_e};globalThis.Leu=ke;})();
